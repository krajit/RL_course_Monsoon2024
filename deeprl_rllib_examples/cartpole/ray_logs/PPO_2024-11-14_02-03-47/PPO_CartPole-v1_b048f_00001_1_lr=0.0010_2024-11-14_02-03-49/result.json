{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4842963218688965, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.811824836525866, "policy_loss": -0.051271034156783454, "vf_loss": 5.85616845725685, "vf_explained_var": 0.42498387290585427, "kl": 0.03463699716830937, "entropy": 0.6590960304583272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": 86.0, "episode_reward_min": 9.0, "episode_reward_mean": 22.576271186440678, "episode_len_mean": 22.576271186440678, "episode_media": {}, "episodes_timesteps_total": 3996, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 86.0}, "policy_reward_mean": {"default_policy": 22.576271186440678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 13.0, 32.0, 13.0, 13.0, 13.0, 15.0, 26.0, 17.0, 15.0, 17.0, 37.0, 11.0, 15.0, 23.0, 22.0, 49.0, 49.0, 37.0, 51.0, 30.0, 9.0, 21.0, 11.0, 13.0, 26.0, 12.0, 17.0, 15.0, 39.0, 20.0, 32.0, 20.0, 22.0, 30.0, 15.0, 23.0, 23.0, 56.0, 27.0, 25.0, 33.0, 18.0, 14.0, 22.0, 72.0, 18.0, 22.0, 32.0, 15.0, 19.0, 35.0, 27.0, 11.0, 10.0, 18.0, 26.0, 26.0, 12.0, 20.0, 30.0, 11.0, 12.0, 16.0, 57.0, 25.0, 28.0, 32.0, 20.0, 37.0, 26.0, 12.0, 14.0, 35.0, 15.0, 14.0, 23.0, 33.0, 9.0, 17.0, 12.0, 23.0, 20.0, 16.0, 33.0, 10.0, 10.0, 20.0, 14.0, 37.0, 20.0, 15.0, 23.0, 19.0, 16.0, 20.0, 15.0, 20.0, 18.0, 16.0, 13.0, 30.0, 19.0, 20.0, 10.0, 28.0, 11.0, 10.0, 37.0, 26.0, 16.0, 19.0, 24.0, 20.0, 13.0, 12.0, 25.0, 16.0, 10.0, 35.0, 23.0, 25.0, 23.0, 11.0, 33.0, 14.0, 33.0, 18.0, 21.0, 30.0, 22.0, 28.0, 18.0, 24.0, 10.0, 16.0, 12.0, 16.0, 12.0, 29.0, 23.0, 17.0, 54.0, 10.0, 26.0, 21.0, 26.0, 21.0, 13.0, 11.0, 24.0, 19.0, 14.0, 34.0, 12.0, 15.0, 18.0, 17.0, 12.0, 30.0, 34.0, 15.0, 22.0, 20.0, 45.0, 14.0, 39.0, 13.0, 86.0, 11.0, 34.0, 34.0, 30.0, 12.0, 48.0, 20.0, 20.0], "episode_lengths": [23, 13, 32, 13, 13, 13, 15, 26, 17, 15, 17, 37, 11, 15, 23, 22, 49, 49, 37, 51, 30, 9, 21, 11, 13, 26, 12, 17, 15, 39, 20, 32, 20, 22, 30, 15, 23, 23, 56, 27, 25, 33, 18, 14, 22, 72, 18, 22, 32, 15, 19, 35, 27, 11, 10, 18, 26, 26, 12, 20, 30, 11, 12, 16, 57, 25, 28, 32, 20, 37, 26, 12, 14, 35, 15, 14, 23, 33, 9, 17, 12, 23, 20, 16, 33, 10, 10, 20, 14, 37, 20, 15, 23, 19, 16, 20, 15, 20, 18, 16, 13, 30, 19, 20, 10, 28, 11, 10, 37, 26, 16, 19, 24, 20, 13, 12, 25, 16, 10, 35, 23, 25, 23, 11, 33, 14, 33, 18, 21, 30, 22, 28, 18, 24, 10, 16, 12, 16, 12, 29, 23, 17, 54, 10, 26, 21, 26, 21, 13, 11, 24, 19, 14, 34, 12, 15, 18, 17, 12, 30, 34, 15, 22, 20, 45, 14, 39, 13, 86, 11, 34, 34, 30, 12, 48, 20, 20], "policy_default_policy_reward": [23.0, 13.0, 32.0, 13.0, 13.0, 13.0, 15.0, 26.0, 17.0, 15.0, 17.0, 37.0, 11.0, 15.0, 23.0, 22.0, 49.0, 49.0, 37.0, 51.0, 30.0, 9.0, 21.0, 11.0, 13.0, 26.0, 12.0, 17.0, 15.0, 39.0, 20.0, 32.0, 20.0, 22.0, 30.0, 15.0, 23.0, 23.0, 56.0, 27.0, 25.0, 33.0, 18.0, 14.0, 22.0, 72.0, 18.0, 22.0, 32.0, 15.0, 19.0, 35.0, 27.0, 11.0, 10.0, 18.0, 26.0, 26.0, 12.0, 20.0, 30.0, 11.0, 12.0, 16.0, 57.0, 25.0, 28.0, 32.0, 20.0, 37.0, 26.0, 12.0, 14.0, 35.0, 15.0, 14.0, 23.0, 33.0, 9.0, 17.0, 12.0, 23.0, 20.0, 16.0, 33.0, 10.0, 10.0, 20.0, 14.0, 37.0, 20.0, 15.0, 23.0, 19.0, 16.0, 20.0, 15.0, 20.0, 18.0, 16.0, 13.0, 30.0, 19.0, 20.0, 10.0, 28.0, 11.0, 10.0, 37.0, 26.0, 16.0, 19.0, 24.0, 20.0, 13.0, 12.0, 25.0, 16.0, 10.0, 35.0, 23.0, 25.0, 23.0, 11.0, 33.0, 14.0, 33.0, 18.0, 21.0, 30.0, 22.0, 28.0, 18.0, 24.0, 10.0, 16.0, 12.0, 16.0, 12.0, 29.0, 23.0, 17.0, 54.0, 10.0, 26.0, 21.0, 26.0, 21.0, 13.0, 11.0, 24.0, 19.0, 14.0, 34.0, 12.0, 15.0, 18.0, 17.0, 12.0, 30.0, 34.0, 15.0, 22.0, 20.0, 45.0, 14.0, 39.0, 13.0, 86.0, 11.0, 34.0, 34.0, 30.0, 12.0, 48.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842597502706111, "mean_inference_ms": 0.9908308506640698, "mean_action_processing_ms": 0.10213068717919686, "mean_env_wait_ms": 0.04281149550107359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037773854314944164, "StateBufferConnector_ms": 0.003949127628304864, "ViewRequirementAgentConnector_ms": 0.10685759075617386}, "num_episodes": 177, "episode_return_max": 86.0, "episode_return_min": 9.0, "episode_return_mean": 22.576271186440678, "episodes_this_iter": 177}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.8064371347432, "num_env_steps_trained_throughput_per_sec": 485.8064371347432, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8233.741, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8233.681, "sample_time_ms": 2921.864, "load_time_ms": 0.395, "load_throughput": 10137290.634, "learn_time_ms": 5305.696, "learn_throughput": 753.907, "synch_weights_time_ms": 5.006}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-06", "timestamp": 1731549846, "time_this_iter_s": 8.239336252212524, "time_total_s": 8.239336252212524, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.239336252212524, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.108333333333334, "ram_util_percent": 56.258333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1882503032684326, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 7.964569903958228, "policy_loss": -0.029685975671295196, "vf_loss": 7.98835431427084, "vf_explained_var": 0.21072463072756284, "kl": 0.019671825025836177, "entropy": 0.598426600105019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 210.0, "episode_reward_min": 10.0, "episode_reward_mean": 46.66, "episode_len_mean": 46.66, "episode_media": {}, "episodes_timesteps_total": 4666, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 210.0}, "policy_reward_mean": {"default_policy": 46.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 26.0, 21.0, 13.0, 11.0, 24.0, 19.0, 14.0, 34.0, 12.0, 15.0, 18.0, 17.0, 12.0, 30.0, 34.0, 15.0, 22.0, 20.0, 45.0, 14.0, 39.0, 13.0, 86.0, 11.0, 34.0, 34.0, 30.0, 12.0, 48.0, 20.0, 20.0, 44.0, 63.0, 44.0, 18.0, 80.0, 194.0, 107.0, 15.0, 51.0, 17.0, 54.0, 84.0, 96.0, 68.0, 20.0, 77.0, 82.0, 87.0, 61.0, 130.0, 57.0, 165.0, 80.0, 45.0, 55.0, 45.0, 56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0], "episode_lengths": [21, 26, 21, 13, 11, 24, 19, 14, 34, 12, 15, 18, 17, 12, 30, 34, 15, 22, 20, 45, 14, 39, 13, 86, 11, 34, 34, 30, 12, 48, 20, 20, 44, 63, 44, 18, 80, 194, 107, 15, 51, 17, 54, 84, 96, 68, 20, 77, 82, 87, 61, 130, 57, 165, 80, 45, 55, 45, 56, 43, 27, 22, 100, 31, 44, 24, 26, 20, 72, 21, 16, 38, 83, 10, 36, 80, 71, 210, 41, 48, 15, 45, 41, 17, 58, 30, 42, 18, 24, 24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75], "policy_default_policy_reward": [21.0, 26.0, 21.0, 13.0, 11.0, 24.0, 19.0, 14.0, 34.0, 12.0, 15.0, 18.0, 17.0, 12.0, 30.0, 34.0, 15.0, 22.0, 20.0, 45.0, 14.0, 39.0, 13.0, 86.0, 11.0, 34.0, 34.0, 30.0, 12.0, 48.0, 20.0, 20.0, 44.0, 63.0, 44.0, 18.0, 80.0, 194.0, 107.0, 15.0, 51.0, 17.0, 54.0, 84.0, 96.0, 68.0, 20.0, 77.0, 82.0, 87.0, 61.0, 130.0, 57.0, 165.0, 80.0, 45.0, 55.0, 45.0, 56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2714002271969242, "mean_inference_ms": 0.9760148376179388, "mean_action_processing_ms": 0.10042005979349938, "mean_env_wait_ms": 0.042154770518375975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003894329071044922, "StateBufferConnector_ms": 0.003815889358520508, "ViewRequirementAgentConnector_ms": 0.10300016403198242}, "num_episodes": 68, "episode_return_max": 210.0, "episode_return_min": 10.0, "episode_return_mean": 46.66, "episodes_this_iter": 68}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.40026692709705, "num_env_steps_trained_throughput_per_sec": 497.40026692709705, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8137.781, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8137.728, "sample_time_ms": 2844.031, "load_time_ms": 0.399, "load_throughput": 10028222.355, "learn_time_ms": 5287.828, "learn_throughput": 756.454, "synch_weights_time_ms": 4.879}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-14", "timestamp": 1731549854, "time_this_iter_s": 8.047154903411865, "time_total_s": 16.28649115562439, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.28649115562439, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.65, "ram_util_percent": 56.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9028986692428589, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 8.963315773522982, "policy_loss": -0.02356855569767856, "vf_loss": 8.982710627586611, "vf_explained_var": 0.09365799529578096, "kl": 0.013912489420965386, "entropy": 0.555325714811202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 315.0, "episode_reward_min": 10.0, "episode_reward_mean": 79.15, "episode_len_mean": 79.15, "episode_media": {}, "episodes_timesteps_total": 7915, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 315.0}, "policy_reward_mean": {"default_policy": 79.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 63.0, 44.0, 18.0, 80.0, 194.0, 107.0, 15.0, 51.0, 17.0, 54.0, 84.0, 96.0, 68.0, 20.0, 77.0, 82.0, 87.0, 61.0, 130.0, 57.0, 165.0, 80.0, 45.0, 55.0, 45.0, 56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0], "episode_lengths": [44, 63, 44, 18, 80, 194, 107, 15, 51, 17, 54, 84, 96, 68, 20, 77, 82, 87, 61, 130, 57, 165, 80, 45, 55, 45, 56, 43, 27, 22, 100, 31, 44, 24, 26, 20, 72, 21, 16, 38, 83, 10, 36, 80, 71, 210, 41, 48, 15, 45, 41, 17, 58, 30, 42, 18, 24, 24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263], "policy_default_policy_reward": [44.0, 63.0, 44.0, 18.0, 80.0, 194.0, 107.0, 15.0, 51.0, 17.0, 54.0, 84.0, 96.0, 68.0, 20.0, 77.0, 82.0, 87.0, 61.0, 130.0, 57.0, 165.0, 80.0, 45.0, 55.0, 45.0, 56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26490647910319176, "mean_inference_ms": 0.974837235545539, "mean_action_processing_ms": 0.10044354796498207, "mean_env_wait_ms": 0.042020101936147664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004076957702636719, "StateBufferConnector_ms": 0.0037856101989746094, "ViewRequirementAgentConnector_ms": 0.10207962989807129}, "num_episodes": 32, "episode_return_max": 315.0, "episode_return_min": 10.0, "episode_return_mean": 79.15, "episodes_this_iter": 32}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.87922561651044, "num_env_steps_trained_throughput_per_sec": 497.87922561651044, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8103.217, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8103.169, "sample_time_ms": 2800.545, "load_time_ms": 0.387, "load_throughput": 10335040.657, "learn_time_ms": 5296.818, "learn_throughput": 755.17, "synch_weights_time_ms": 4.881}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-22", "timestamp": 1731549862, "time_this_iter_s": 8.03779649734497, "time_total_s": 24.32428765296936, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.32428765296936, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 56.45454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3338690996170044, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.512610924115744, "policy_loss": -0.023943028550955557, "vf_loss": 9.533848128780242, "vf_explained_var": -0.027726869621584493, "kl": 0.009019423302683042, "entropy": 0.5570166173481172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 10.0, "episode_reward_mean": 109.0, "episode_len_mean": 109.0, "episode_media": {}, "episodes_timesteps_total": 10900, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 400.0}, "policy_reward_mean": {"default_policy": 109.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0, 82.0, 87.0, 61.0, 130.0, 57.0, 165.0, 80.0, 45.0, 55.0, 45.0, 56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0], "episode_lengths": [77, 82, 87, 61, 130, 57, 165, 80, 45, 55, 45, 56, 43, 27, 22, 100, 31, 44, 24, 26, 20, 72, 21, 16, 38, 83, 10, 36, 80, 71, 210, 41, 48, 15, 45, 41, 17, 58, 30, 42, 18, 24, 24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208], "policy_default_policy_reward": [77.0, 82.0, 87.0, 61.0, 130.0, 57.0, 165.0, 80.0, 45.0, 55.0, 45.0, 56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26227309077508365, "mean_inference_ms": 0.9722888055505859, "mean_action_processing_ms": 0.10005709443928784, "mean_env_wait_ms": 0.041887507478534085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004195690155029297, "StateBufferConnector_ms": 0.0037741661071777344, "ViewRequirementAgentConnector_ms": 0.10186457633972168}, "num_episodes": 15, "episode_return_max": 400.0, "episode_return_min": 10.0, "episode_return_mean": 109.0, "episodes_this_iter": 15}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.3973628206177, "num_env_steps_trained_throughput_per_sec": 498.3973628206177, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8083.846, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8083.803, "sample_time_ms": 2790.771, "load_time_ms": 0.413, "load_throughput": 9688012.704, "learn_time_ms": 5287.233, "learn_throughput": 756.539, "synch_weights_time_ms": 4.876}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-30", "timestamp": 1731549870, "time_this_iter_s": 8.028947353363037, "time_total_s": 32.3532350063324, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.3532350063324, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.55833333333333, "ram_util_percent": 56.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2876336574554443, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.600868120501119, "policy_loss": -0.02344212453632105, "vf_loss": 9.621321839158252, "vf_explained_var": -0.19346342580292814, "kl": 0.009961328105115715, "entropy": 0.5273895570667841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 10.0, "episode_reward_mean": 138.11, "episode_len_mean": 138.11, "episode_media": {}, "episodes_timesteps_total": 13811, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 138.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0], "episode_lengths": [56, 43, 27, 22, 100, 31, 44, 24, 26, 20, 72, 21, 16, 38, 83, 10, 36, 80, 71, 210, 41, 48, 15, 45, 41, 17, 58, 30, 42, 18, 24, 24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208, 405, 494, 322, 264, 328, 457, 206, 301, 500, 186, 332], "policy_default_policy_reward": [56.0, 43.0, 27.0, 22.0, 100.0, 31.0, 44.0, 24.0, 26.0, 20.0, 72.0, 21.0, 16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2599405644495377, "mean_inference_ms": 0.9717106776894486, "mean_action_processing_ms": 0.09974837996471603, "mean_env_wait_ms": 0.04177734129678177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004174232482910156, "StateBufferConnector_ms": 0.0037567615509033203, "ViewRequirementAgentConnector_ms": 0.10158872604370117}, "num_episodes": 11, "episode_return_max": 500.0, "episode_return_min": 10.0, "episode_return_mean": 138.11, "episodes_this_iter": 11}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.36639309341155, "num_env_steps_trained_throughput_per_sec": 488.36639309341155, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8105.193, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8105.153, "sample_time_ms": 2806.276, "load_time_ms": 0.4, "load_throughput": 9999532.721, "learn_time_ms": 5293.003, "learn_throughput": 755.715, "synch_weights_time_ms": 4.972}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-38", "timestamp": 1731549878, "time_this_iter_s": 8.194066047668457, "time_total_s": 40.547301054000854, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.547301054000854, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.63333333333334, "ram_util_percent": 56.42499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1495070457458496, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.608205019017701, "policy_loss": -0.02478318070612287, "vf_loss": 9.63053402029058, "vf_explained_var": -0.2557924564807646, "kl": 0.008180576024368589, "entropy": 0.5036450335415461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 10.0, "episode_reward_mean": 174.5, "episode_len_mean": 174.5, "episode_media": {}, "episodes_timesteps_total": 17450, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 174.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0], "episode_lengths": [16, 38, 83, 10, 36, 80, 71, 210, 41, 48, 15, 45, 41, 17, 58, 30, 42, 18, 24, 24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208, 405, 494, 322, 264, 328, 457, 206, 301, 500, 186, 332, 216, 350, 372, 378, 352, 500, 500, 142, 167, 500, 337, 311], "policy_default_policy_reward": [16.0, 38.0, 83.0, 10.0, 36.0, 80.0, 71.0, 210.0, 41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2579939879172846, "mean_inference_ms": 0.973267681998691, "mean_action_processing_ms": 0.09980763583359505, "mean_env_wait_ms": 0.041758429927437356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004153013229370117, "StateBufferConnector_ms": 0.0037689208984375, "ViewRequirementAgentConnector_ms": 0.10194015502929688}, "num_episodes": 12, "episode_return_max": 500.0, "episode_return_min": 10.0, "episode_return_mean": 174.5, "episodes_this_iter": 12}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.15438519810164, "num_env_steps_trained_throughput_per_sec": 460.15438519810164, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8203.119, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8203.078, "sample_time_ms": 2809.033, "load_time_ms": 0.405, "load_throughput": 9881544.714, "learn_time_ms": 5388.164, "learn_throughput": 742.368, "synch_weights_time_ms": 4.975}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-47", "timestamp": 1731549887, "time_this_iter_s": 8.696360111236572, "time_total_s": 49.24366116523743, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.24366116523743, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.016666666666666, "ram_util_percent": 56.56666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5687550902366638, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.797509342111567, "policy_loss": -0.0258858503072813, "vf_loss": 9.82097104185371, "vf_explained_var": -0.4764203087616992, "kl": 0.008080518253856086, "entropy": 0.4921237999713549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 15.0, "episode_reward_mean": 207.2, "episode_len_mean": 207.2, "episode_media": {}, "episodes_timesteps_total": 20720, "policy_reward_min": {"default_policy": 15.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 207.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [41, 48, 15, 45, 41, 17, 58, 30, 42, 18, 24, 24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208, 405, 494, 322, 264, 328, 457, 206, 301, 500, 186, 332, 216, 350, 372, 378, 352, 500, 500, 142, 167, 500, 337, 311, 500, 500, 500, 314, 500, 500, 500, 500], "policy_default_policy_reward": [41.0, 48.0, 15.0, 45.0, 41.0, 17.0, 58.0, 30.0, 42.0, 18.0, 24.0, 24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25677247329169123, "mean_inference_ms": 0.9746547616552175, "mean_action_processing_ms": 0.09993190453103687, "mean_env_wait_ms": 0.041766146180283965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040853023529052734, "StateBufferConnector_ms": 0.0038101673126220703, "ViewRequirementAgentConnector_ms": 0.102142333984375}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 15.0, "episode_return_mean": 207.2, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.94682524625256, "num_env_steps_trained_throughput_per_sec": 494.94682524625256, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8185.771, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8185.732, "sample_time_ms": 2800.705, "load_time_ms": 0.42, "load_throughput": 9534056.827, "learn_time_ms": 5379.145, "learn_throughput": 743.613, "synch_weights_time_ms": 4.97}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "b048f_00001", "date": "2024-11-14_02-04-55", "timestamp": 1731549895, "time_this_iter_s": 8.085005283355713, "time_total_s": 57.32866644859314, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.32866644859314, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.59166666666667, "ram_util_percent": 56.45833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8408364057540894, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.733822044249504, "policy_loss": -0.0285687596907699, "vf_loss": 9.759519361680553, "vf_explained_var": -0.20637541400488987, "kl": 0.009571520877397956, "entropy": 0.5008104279156654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 23.0, "episode_reward_mean": 245.88, "episode_len_mean": 245.88, "episode_media": {}, "episodes_timesteps_total": 24588, "policy_reward_min": {"default_policy": 23.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 245.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 346.0, 500.0, 258.0, 500.0, 500.0, 500.0, 276.0, 219.0, 148.0], "episode_lengths": [24, 48, 37, 77, 23, 54, 115, 44, 71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208, 405, 494, 322, 264, 328, 457, 206, 301, 500, 186, 332, 216, 350, 372, 378, 352, 500, 500, 142, 167, 500, 337, 311, 500, 500, 500, 314, 500, 500, 500, 500, 500, 500, 346, 500, 258, 500, 500, 500, 276, 219, 148], "policy_default_policy_reward": [24.0, 48.0, 37.0, 77.0, 23.0, 54.0, 115.0, 44.0, 71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 346.0, 500.0, 258.0, 500.0, 500.0, 500.0, 276.0, 219.0, 148.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25512149419122404, "mean_inference_ms": 0.9770926516161942, "mean_action_processing_ms": 0.1001696708982124, "mean_env_wait_ms": 0.04179645540799108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039670467376708984, "StateBufferConnector_ms": 0.0038378238677978516, "ViewRequirementAgentConnector_ms": 0.10283732414245605}, "num_episodes": 11, "episode_return_max": 500.0, "episode_return_min": 23.0, "episode_return_mean": 245.88, "episodes_this_iter": 11}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.2983200630829, "num_env_steps_trained_throughput_per_sec": 460.2983200630829, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8248.803, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8248.765, "sample_time_ms": 2819.205, "load_time_ms": 0.416, "load_throughput": 9617206.076, "learn_time_ms": 5423.668, "learn_throughput": 737.508, "synch_weights_time_ms": 4.98}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "b048f_00001", "date": "2024-11-14_02-05-04", "timestamp": 1731549904, "time_this_iter_s": 8.693527460098267, "time_total_s": 66.0221939086914, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.0221939086914, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.88333333333333, "ram_util_percent": 56.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6385469436645508, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.692795627347884, "policy_loss": -0.028713109003760482, "vf_loss": 9.719397549475392, "vf_explained_var": -0.6024352547942952, "kl": 0.007037282001971241, "entropy": 0.5013726964753161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 34.0, "episode_reward_mean": 281.66, "episode_len_mean": 281.66, "episode_media": {}, "episodes_timesteps_total": 28166, "policy_reward_min": {"default_policy": 34.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 281.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 346.0, 500.0, 258.0, 500.0, 500.0, 500.0, 276.0, 219.0, 148.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [71, 66, 75, 58, 154, 80, 144, 90, 107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208, 405, 494, 322, 264, 328, 457, 206, 301, 500, 186, 332, 216, 350, 372, 378, 352, 500, 500, 142, 167, 500, 337, 311, 500, 500, 500, 314, 500, 500, 500, 500, 500, 500, 346, 500, 258, 500, 500, 500, 276, 219, 148, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [71.0, 66.0, 75.0, 58.0, 154.0, 80.0, 144.0, 90.0, 107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 346.0, 500.0, 258.0, 500.0, 500.0, 500.0, 276.0, 219.0, 148.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25384735366418665, "mean_inference_ms": 0.9787310731842996, "mean_action_processing_ms": 0.10033236102052985, "mean_env_wait_ms": 0.04181632519183813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003969669342041016, "StateBufferConnector_ms": 0.003844022750854492, "ViewRequirementAgentConnector_ms": 0.10289406776428223}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 34.0, "episode_return_mean": 281.66, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.36201599928893, "num_env_steps_trained_throughput_per_sec": 477.36201599928893, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8263.313, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8263.275, "sample_time_ms": 2809.892, "load_time_ms": 0.41, "load_throughput": 9752305.367, "learn_time_ms": 5447.481, "learn_throughput": 734.284, "synch_weights_time_ms": 5.004}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "b048f_00001", "date": "2024-11-14_02-05-12", "timestamp": 1731549912, "time_this_iter_s": 8.382599592208862, "time_total_s": 74.40479350090027, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.40479350090027, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.35, "ram_util_percent": 56.50833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9616066217422485, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.435696145539643, "policy_loss": -0.02361987520169507, "vf_loss": 9.455794930714433, "vf_explained_var": -0.581379637923292, "kl": 0.011736835498419116, "entropy": 0.48195109091779237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 34.0, "episode_reward_mean": 310.01, "episode_len_mean": 310.01, "episode_media": {}, "episodes_timesteps_total": 31001, "policy_reward_min": {"default_policy": 34.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 310.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 346.0, 500.0, 258.0, 500.0, 500.0, 500.0, 276.0, 219.0, 148.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 500.0, 500.0, 295.0, 327.0, 500.0, 500.0], "episode_lengths": [107, 103, 138, 129, 171, 315, 184, 54, 148, 162, 169, 69, 230, 125, 112, 160, 60, 43, 85, 102, 53, 37, 34, 168, 161, 125, 263, 323, 274, 243, 233, 226, 247, 350, 98, 240, 287, 400, 359, 188, 264, 208, 405, 494, 322, 264, 328, 457, 206, 301, 500, 186, 332, 216, 350, 372, 378, 352, 500, 500, 142, 167, 500, 337, 311, 500, 500, 500, 314, 500, 500, 500, 500, 500, 500, 346, 500, 258, 500, 500, 500, 276, 219, 148, 500, 500, 500, 500, 500, 500, 500, 500, 451, 500, 500, 500, 295, 327, 500, 500], "policy_default_policy_reward": [107.0, 103.0, 138.0, 129.0, 171.0, 315.0, 184.0, 54.0, 148.0, 162.0, 169.0, 69.0, 230.0, 125.0, 112.0, 160.0, 60.0, 43.0, 85.0, 102.0, 53.0, 37.0, 34.0, 168.0, 161.0, 125.0, 263.0, 323.0, 274.0, 243.0, 233.0, 226.0, 247.0, 350.0, 98.0, 240.0, 287.0, 400.0, 359.0, 188.0, 264.0, 208.0, 405.0, 494.0, 322.0, 264.0, 328.0, 457.0, 206.0, 301.0, 500.0, 186.0, 332.0, 216.0, 350.0, 372.0, 378.0, 352.0, 500.0, 500.0, 142.0, 167.0, 500.0, 337.0, 311.0, 500.0, 500.0, 500.0, 314.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 346.0, 500.0, 258.0, 500.0, 500.0, 500.0, 276.0, 219.0, 148.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 500.0, 500.0, 295.0, 327.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527662393546708, "mean_inference_ms": 0.9797254796897954, "mean_action_processing_ms": 0.1003825960323505, "mean_env_wait_ms": 0.041819151907183584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004101991653442383, "StateBufferConnector_ms": 0.003855466842651367, "ViewRequirementAgentConnector_ms": 0.10322213172912598}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 34.0, "episode_return_mean": 310.01, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.52955157622546, "num_env_steps_trained_throughput_per_sec": 487.52955157622546, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8257.446, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8257.409, "sample_time_ms": 2813.572, "load_time_ms": 0.419, "load_throughput": 9543896.695, "learn_time_ms": 5437.975, "learn_throughput": 735.568, "synch_weights_time_ms": 4.96}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": true, "training_iteration": 10, "trial_id": "b048f_00001", "date": "2024-11-14_02-05-20", "timestamp": 1731549920, "time_this_iter_s": 8.20877456665039, "time_total_s": 82.61356806755066, "pid": 9604, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82.61356806755066, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.75, "ram_util_percent": 56.64166666666667}}
