{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.250961780548096, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.01, "total_loss": 5.640778918420115, "policy_loss": -0.0499455155023644, "vf_loss": 5.6824890610992265, "vf_explained_var": 0.3688535466629972, "kl": 0.041176876582313594, "entropy": 0.6546665775519546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": 65.0, "episode_reward_min": 9.0, "episode_reward_mean": 22.867816091954023, "episode_len_mean": 22.867816091954023, "episode_media": {}, "episodes_timesteps_total": 3979, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 65.0}, "policy_reward_mean": {"default_policy": 22.867816091954023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 9.0, 14.0, 18.0, 14.0, 11.0, 17.0, 18.0, 12.0, 16.0, 46.0, 18.0, 29.0, 14.0, 24.0, 17.0, 18.0, 65.0, 37.0, 25.0, 26.0, 13.0, 22.0, 16.0, 31.0, 17.0, 20.0, 14.0, 24.0, 23.0, 15.0, 41.0, 33.0, 39.0, 9.0, 16.0, 14.0, 20.0, 40.0, 17.0, 24.0, 59.0, 13.0, 18.0, 15.0, 16.0, 35.0, 38.0, 19.0, 44.0, 31.0, 16.0, 15.0, 16.0, 16.0, 32.0, 18.0, 25.0, 18.0, 30.0, 14.0, 22.0, 15.0, 41.0, 43.0, 25.0, 14.0, 58.0, 18.0, 16.0, 27.0, 33.0, 20.0, 25.0, 18.0, 18.0, 14.0, 27.0, 18.0, 41.0, 17.0, 9.0, 29.0, 36.0, 12.0, 15.0, 23.0, 19.0, 15.0, 23.0, 20.0, 12.0, 14.0, 44.0, 16.0, 25.0, 11.0, 31.0, 13.0, 19.0, 39.0, 22.0, 19.0, 20.0, 27.0, 14.0, 11.0, 16.0, 22.0, 37.0, 43.0, 10.0, 10.0, 36.0, 19.0, 15.0, 13.0, 21.0, 64.0, 14.0, 14.0, 28.0, 21.0, 22.0, 32.0, 18.0, 28.0, 20.0, 16.0, 14.0, 12.0, 10.0, 45.0, 18.0, 20.0, 14.0, 20.0, 16.0, 12.0, 25.0, 33.0, 36.0, 10.0, 14.0, 19.0, 19.0, 14.0, 12.0, 17.0, 22.0, 23.0, 17.0, 45.0, 11.0, 16.0, 15.0, 27.0, 22.0, 22.0, 16.0, 20.0, 19.0, 32.0, 32.0, 11.0, 61.0, 20.0, 23.0, 36.0, 13.0, 29.0, 13.0, 64.0, 24.0], "episode_lengths": [15, 9, 14, 18, 14, 11, 17, 18, 12, 16, 46, 18, 29, 14, 24, 17, 18, 65, 37, 25, 26, 13, 22, 16, 31, 17, 20, 14, 24, 23, 15, 41, 33, 39, 9, 16, 14, 20, 40, 17, 24, 59, 13, 18, 15, 16, 35, 38, 19, 44, 31, 16, 15, 16, 16, 32, 18, 25, 18, 30, 14, 22, 15, 41, 43, 25, 14, 58, 18, 16, 27, 33, 20, 25, 18, 18, 14, 27, 18, 41, 17, 9, 29, 36, 12, 15, 23, 19, 15, 23, 20, 12, 14, 44, 16, 25, 11, 31, 13, 19, 39, 22, 19, 20, 27, 14, 11, 16, 22, 37, 43, 10, 10, 36, 19, 15, 13, 21, 64, 14, 14, 28, 21, 22, 32, 18, 28, 20, 16, 14, 12, 10, 45, 18, 20, 14, 20, 16, 12, 25, 33, 36, 10, 14, 19, 19, 14, 12, 17, 22, 23, 17, 45, 11, 16, 15, 27, 22, 22, 16, 20, 19, 32, 32, 11, 61, 20, 23, 36, 13, 29, 13, 64, 24], "policy_default_policy_reward": [15.0, 9.0, 14.0, 18.0, 14.0, 11.0, 17.0, 18.0, 12.0, 16.0, 46.0, 18.0, 29.0, 14.0, 24.0, 17.0, 18.0, 65.0, 37.0, 25.0, 26.0, 13.0, 22.0, 16.0, 31.0, 17.0, 20.0, 14.0, 24.0, 23.0, 15.0, 41.0, 33.0, 39.0, 9.0, 16.0, 14.0, 20.0, 40.0, 17.0, 24.0, 59.0, 13.0, 18.0, 15.0, 16.0, 35.0, 38.0, 19.0, 44.0, 31.0, 16.0, 15.0, 16.0, 16.0, 32.0, 18.0, 25.0, 18.0, 30.0, 14.0, 22.0, 15.0, 41.0, 43.0, 25.0, 14.0, 58.0, 18.0, 16.0, 27.0, 33.0, 20.0, 25.0, 18.0, 18.0, 14.0, 27.0, 18.0, 41.0, 17.0, 9.0, 29.0, 36.0, 12.0, 15.0, 23.0, 19.0, 15.0, 23.0, 20.0, 12.0, 14.0, 44.0, 16.0, 25.0, 11.0, 31.0, 13.0, 19.0, 39.0, 22.0, 19.0, 20.0, 27.0, 14.0, 11.0, 16.0, 22.0, 37.0, 43.0, 10.0, 10.0, 36.0, 19.0, 15.0, 13.0, 21.0, 64.0, 14.0, 14.0, 28.0, 21.0, 22.0, 32.0, 18.0, 28.0, 20.0, 16.0, 14.0, 12.0, 10.0, 45.0, 18.0, 20.0, 14.0, 20.0, 16.0, 12.0, 25.0, 33.0, 36.0, 10.0, 14.0, 19.0, 19.0, 14.0, 12.0, 17.0, 22.0, 23.0, 17.0, 45.0, 11.0, 16.0, 15.0, 27.0, 22.0, 22.0, 16.0, 20.0, 19.0, 32.0, 32.0, 11.0, 61.0, 20.0, 23.0, 36.0, 13.0, 29.0, 13.0, 64.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.275542954809604, "mean_inference_ms": 0.9833048413398007, "mean_action_processing_ms": 0.1007538684007318, "mean_env_wait_ms": 0.04121233188802018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00380770913485823, "StateBufferConnector_ms": 0.0036926105104643724, "ViewRequirementAgentConnector_ms": 0.10318221717045226}, "num_episodes": 174, "episode_return_max": 65.0, "episode_return_min": 9.0, "episode_return_mean": 22.867816091954023, "episodes_this_iter": 174}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.8754169161049, "num_env_steps_trained_throughput_per_sec": 484.8754169161049, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8249.556, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8249.474, "sample_time_ms": 2881.926, "load_time_ms": 0.267, "load_throughput": 14993043.789, "learn_time_ms": 5361.34, "learn_throughput": 746.082, "synch_weights_time_ms": 5.325}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-06", "timestamp": 1731549846, "time_this_iter_s": 8.255290031433105, "time_total_s": 8.255290031433105, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.255290031433105, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.4, "ram_util_percent": 56.26666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0266404151916504, "cur_kl_coeff": 0.3, "cur_lr": 0.01, "total_loss": 8.268705604922387, "policy_loss": -0.028918509227373906, "vf_loss": 8.290205144369475, "vf_explained_var": 0.2319992902458355, "kl": 0.024729796306527004, "entropy": 0.5882789047174556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": 10.0, "episode_reward_mean": 47.34, "episode_len_mean": 47.34, "episode_media": {}, "episodes_timesteps_total": 4734, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 217.0}, "policy_reward_mean": {"default_policy": 47.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 25.0, 33.0, 36.0, 10.0, 14.0, 19.0, 19.0, 14.0, 12.0, 17.0, 22.0, 23.0, 17.0, 45.0, 11.0, 16.0, 15.0, 27.0, 22.0, 22.0, 16.0, 20.0, 19.0, 32.0, 32.0, 11.0, 61.0, 20.0, 23.0, 36.0, 13.0, 29.0, 13.0, 64.0, 24.0, 17.0, 45.0, 146.0, 38.0, 46.0, 72.0, 108.0, 99.0, 15.0, 66.0, 42.0, 14.0, 25.0, 111.0, 63.0, 22.0, 12.0, 113.0, 16.0, 119.0, 75.0, 25.0, 17.0, 48.0, 44.0, 111.0, 33.0, 48.0, 147.0, 52.0, 67.0, 39.0, 18.0, 98.0, 30.0, 30.0, 66.0, 52.0, 73.0, 105.0, 143.0, 41.0, 64.0, 22.0, 217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0], "episode_lengths": [12, 25, 33, 36, 10, 14, 19, 19, 14, 12, 17, 22, 23, 17, 45, 11, 16, 15, 27, 22, 22, 16, 20, 19, 32, 32, 11, 61, 20, 23, 36, 13, 29, 13, 64, 24, 17, 45, 146, 38, 46, 72, 108, 99, 15, 66, 42, 14, 25, 111, 63, 22, 12, 113, 16, 119, 75, 25, 17, 48, 44, 111, 33, 48, 147, 52, 67, 39, 18, 98, 30, 30, 66, 52, 73, 105, 143, 41, 64, 22, 217, 25, 57, 22, 82, 24, 29, 83, 36, 125, 77, 23, 90, 10, 85, 11, 22, 44, 116, 75], "policy_default_policy_reward": [12.0, 25.0, 33.0, 36.0, 10.0, 14.0, 19.0, 19.0, 14.0, 12.0, 17.0, 22.0, 23.0, 17.0, 45.0, 11.0, 16.0, 15.0, 27.0, 22.0, 22.0, 16.0, 20.0, 19.0, 32.0, 32.0, 11.0, 61.0, 20.0, 23.0, 36.0, 13.0, 29.0, 13.0, 64.0, 24.0, 17.0, 45.0, 146.0, 38.0, 46.0, 72.0, 108.0, 99.0, 15.0, 66.0, 42.0, 14.0, 25.0, 111.0, 63.0, 22.0, 12.0, 113.0, 16.0, 119.0, 75.0, 25.0, 17.0, 48.0, 44.0, 111.0, 33.0, 48.0, 147.0, 52.0, 67.0, 39.0, 18.0, 98.0, 30.0, 30.0, 66.0, 52.0, 73.0, 105.0, 143.0, 41.0, 64.0, 22.0, 217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2668227577967147, "mean_inference_ms": 0.9801150970383742, "mean_action_processing_ms": 0.10018983976659777, "mean_env_wait_ms": 0.04104888736229337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038118362426757812, "StateBufferConnector_ms": 0.0035681724548339844, "ViewRequirementAgentConnector_ms": 0.10123419761657715}, "num_episodes": 64, "episode_return_max": 217.0, "episode_return_min": 10.0, "episode_return_mean": 47.34, "episodes_this_iter": 64}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.18271213329353, "num_env_steps_trained_throughput_per_sec": 498.18271213329353, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8139.375, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8139.307, "sample_time_ms": 2801.931, "load_time_ms": 0.329, "load_throughput": 12139808.973, "learn_time_ms": 5331.169, "learn_throughput": 750.304, "synch_weights_time_ms": 5.34}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-14", "timestamp": 1731549854, "time_this_iter_s": 8.033240795135498, "time_total_s": 16.288530826568604, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.288530826568604, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.69166666666666, "ram_util_percent": 56.57500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.352034330368042, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.01, "total_loss": 9.063882747773201, "policy_loss": -0.0028141173829514814, "vf_loss": 9.042521314723517, "vf_explained_var": 0.1748399233305326, "kl": 0.053723392812426767, "entropy": 0.5344584029848858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": 10.0, "episode_reward_mean": 77.83, "episode_len_mean": 77.83, "episode_media": {}, "episodes_timesteps_total": 7783, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 217.0}, "policy_reward_mean": {"default_policy": 77.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0, 38.0, 46.0, 72.0, 108.0, 99.0, 15.0, 66.0, 42.0, 14.0, 25.0, 111.0, 63.0, 22.0, 12.0, 113.0, 16.0, 119.0, 75.0, 25.0, 17.0, 48.0, 44.0, 111.0, 33.0, 48.0, 147.0, 52.0, 67.0, 39.0, 18.0, 98.0, 30.0, 30.0, 66.0, 52.0, 73.0, 105.0, 143.0, 41.0, 64.0, 22.0, 217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0, 113.0, 122.0, 200.0, 23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0], "episode_lengths": [146, 38, 46, 72, 108, 99, 15, 66, 42, 14, 25, 111, 63, 22, 12, 113, 16, 119, 75, 25, 17, 48, 44, 111, 33, 48, 147, 52, 67, 39, 18, 98, 30, 30, 66, 52, 73, 105, 143, 41, 64, 22, 217, 25, 57, 22, 82, 24, 29, 83, 36, 125, 77, 23, 90, 10, 85, 11, 22, 44, 116, 75, 113, 122, 200, 23, 114, 56, 38, 122, 27, 117, 169, 190, 148, 137, 197, 134, 148, 35, 44, 97, 16, 11, 111, 150, 53, 111, 85, 91, 86, 184, 138, 55, 62, 206, 33, 138, 30, 164], "policy_default_policy_reward": [146.0, 38.0, 46.0, 72.0, 108.0, 99.0, 15.0, 66.0, 42.0, 14.0, 25.0, 111.0, 63.0, 22.0, 12.0, 113.0, 16.0, 119.0, 75.0, 25.0, 17.0, 48.0, 44.0, 111.0, 33.0, 48.0, 147.0, 52.0, 67.0, 39.0, 18.0, 98.0, 30.0, 30.0, 66.0, 52.0, 73.0, 105.0, 143.0, 41.0, 64.0, 22.0, 217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0, 113.0, 122.0, 200.0, 23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2565058999305493, "mean_inference_ms": 0.9679467965137247, "mean_action_processing_ms": 0.09923469511204015, "mean_env_wait_ms": 0.04059365853611757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039064884185791016, "StateBufferConnector_ms": 0.003554821014404297, "ViewRequirementAgentConnector_ms": 0.0999000072479248}, "num_episodes": 38, "episode_return_max": 217.0, "episode_return_min": 10.0, "episode_return_mean": 77.83, "episodes_this_iter": 38}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.59082703575655, "num_env_steps_trained_throughput_per_sec": 492.59082703575655, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8133.03, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8132.972, "sample_time_ms": 2772.449, "load_time_ms": 0.402, "load_throughput": 9952866.917, "learn_time_ms": 5354.262, "learn_throughput": 747.068, "synch_weights_time_ms": 5.344}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-22", "timestamp": 1731549862, "time_this_iter_s": 8.124892473220825, "time_total_s": 24.41342329978943, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.41342329978943, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.708333333333336, "ram_util_percent": 56.44166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1002490520477295, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.01, "total_loss": 9.247557626232025, "policy_loss": -0.014680391147492393, "vf_loss": 9.256292962002497, "vf_explained_var": 0.5650789853706155, "kl": 0.00880749190650468, "entropy": 0.5359495550073603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 298.0, "episode_reward_min": 10.0, "episode_reward_mean": 104.66, "episode_len_mean": 104.66, "episode_media": {}, "episodes_timesteps_total": 10466, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 298.0}, "policy_reward_mean": {"default_policy": 104.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.0, 33.0, 48.0, 147.0, 52.0, 67.0, 39.0, 18.0, 98.0, 30.0, 30.0, 66.0, 52.0, 73.0, 105.0, 143.0, 41.0, 64.0, 22.0, 217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0, 113.0, 122.0, 200.0, 23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0], "episode_lengths": [111, 33, 48, 147, 52, 67, 39, 18, 98, 30, 30, 66, 52, 73, 105, 143, 41, 64, 22, 217, 25, 57, 22, 82, 24, 29, 83, 36, 125, 77, 23, 90, 10, 85, 11, 22, 44, 116, 75, 113, 122, 200, 23, 114, 56, 38, 122, 27, 117, 169, 190, 148, 137, 197, 134, 148, 35, 44, 97, 16, 11, 111, 150, 53, 111, 85, 91, 86, 184, 138, 55, 62, 206, 33, 138, 30, 164, 89, 237, 125, 173, 92, 298, 121, 209, 154, 177, 125, 205, 179, 237, 149, 84, 214, 130, 164, 172, 219, 168, 298], "policy_default_policy_reward": [111.0, 33.0, 48.0, 147.0, 52.0, 67.0, 39.0, 18.0, 98.0, 30.0, 30.0, 66.0, 52.0, 73.0, 105.0, 143.0, 41.0, 64.0, 22.0, 217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0, 113.0, 122.0, 200.0, 23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2551011133716135, "mean_inference_ms": 0.9703729742983586, "mean_action_processing_ms": 0.09965346282016795, "mean_env_wait_ms": 0.040717596882763746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003929615020751953, "StateBufferConnector_ms": 0.0036118030548095703, "ViewRequirementAgentConnector_ms": 0.10000467300415039}, "num_episodes": 23, "episode_return_max": 298.0, "episode_return_min": 10.0, "episode_return_mean": 104.66, "episodes_this_iter": 23}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.73462157260263, "num_env_steps_trained_throughput_per_sec": 493.73462157260263, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8125.155, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8125.102, "sample_time_ms": 2771.074, "load_time_ms": 0.442, "load_throughput": 9050419.96, "learn_time_ms": 5347.899, "learn_throughput": 747.957, "synch_weights_time_ms": 5.184}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-31", "timestamp": 1731549871, "time_this_iter_s": 8.105175495147705, "time_total_s": 32.518598794937134, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.518598794937134, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.87272727272727, "ram_util_percent": 56.60909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0180203914642334, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.01, "total_loss": 9.057680781169605, "policy_loss": 0.0011559964658351995, "vf_loss": 9.04301092291391, "vf_explained_var": 0.39628859931422816, "kl": 0.020020551646005764, "entropy": 0.5312577896220709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": 10.0, "episode_reward_mean": 130.84, "episode_len_mean": 130.84, "episode_media": {}, "episodes_timesteps_total": 13084, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 376.0}, "policy_reward_mean": {"default_policy": 130.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0, 113.0, 122.0, 200.0, 23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0], "episode_lengths": [217, 25, 57, 22, 82, 24, 29, 83, 36, 125, 77, 23, 90, 10, 85, 11, 22, 44, 116, 75, 113, 122, 200, 23, 114, 56, 38, 122, 27, 117, 169, 190, 148, 137, 197, 134, 148, 35, 44, 97, 16, 11, 111, 150, 53, 111, 85, 91, 86, 184, 138, 55, 62, 206, 33, 138, 30, 164, 89, 237, 125, 173, 92, 298, 121, 209, 154, 177, 125, 205, 179, 237, 149, 84, 214, 130, 164, 172, 219, 168, 298, 146, 177, 199, 376, 143, 235, 189, 218, 94, 155, 251, 217, 302, 357, 116, 137, 192, 192, 161], "policy_default_policy_reward": [217.0, 25.0, 57.0, 22.0, 82.0, 24.0, 29.0, 83.0, 36.0, 125.0, 77.0, 23.0, 90.0, 10.0, 85.0, 11.0, 22.0, 44.0, 116.0, 75.0, 113.0, 122.0, 200.0, 23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2522235568641102, "mean_inference_ms": 0.9715533194349452, "mean_action_processing_ms": 0.09954704137825932, "mean_env_wait_ms": 0.04065416719200768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038192272186279297, "StateBufferConnector_ms": 0.0036284923553466797, "ViewRequirementAgentConnector_ms": 0.09969305992126465}, "num_episodes": 19, "episode_return_max": 376.0, "episode_return_min": 10.0, "episode_return_mean": 130.84, "episodes_this_iter": 19}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.64820485055634, "num_env_steps_trained_throughput_per_sec": 482.64820485055634, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8157.648, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8157.599, "sample_time_ms": 2789.689, "load_time_ms": 0.433, "load_throughput": 9228391.639, "learn_time_ms": 5361.778, "learn_throughput": 746.021, "synch_weights_time_ms": 5.198}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-39", "timestamp": 1731549879, "time_this_iter_s": 8.291967868804932, "time_total_s": 40.810566663742065, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.810566663742065, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.93333333333334, "ram_util_percent": 56.42499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.278735160827637, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.01, "total_loss": 8.549817539030506, "policy_loss": -0.00659165507412806, "vf_loss": 8.550305113741146, "vf_explained_var": 0.7997802656824871, "kl": 0.006028710779904357, "entropy": 0.513424039335661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": 11.0, "episode_reward_mean": 156.04, "episode_len_mean": 156.04, "episode_media": {}, "episodes_timesteps_total": 15604, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 376.0}, "policy_reward_mean": {"default_policy": 156.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0, 220.0, 107.0, 163.0, 126.0, 170.0, 151.0, 228.0, 164.0, 149.0, 235.0, 354.0, 229.0, 193.0, 188.0, 142.0, 192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0], "episode_lengths": [23, 114, 56, 38, 122, 27, 117, 169, 190, 148, 137, 197, 134, 148, 35, 44, 97, 16, 11, 111, 150, 53, 111, 85, 91, 86, 184, 138, 55, 62, 206, 33, 138, 30, 164, 89, 237, 125, 173, 92, 298, 121, 209, 154, 177, 125, 205, 179, 237, 149, 84, 214, 130, 164, 172, 219, 168, 298, 146, 177, 199, 376, 143, 235, 189, 218, 94, 155, 251, 217, 302, 357, 116, 137, 192, 192, 161, 220, 107, 163, 126, 170, 151, 228, 164, 149, 235, 354, 229, 193, 188, 142, 192, 174, 200, 173, 137, 239, 140, 134], "policy_default_policy_reward": [23.0, 114.0, 56.0, 38.0, 122.0, 27.0, 117.0, 169.0, 190.0, 148.0, 137.0, 197.0, 134.0, 148.0, 35.0, 44.0, 97.0, 16.0, 11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0, 220.0, 107.0, 163.0, 126.0, 170.0, 151.0, 228.0, 164.0, 149.0, 235.0, 354.0, 229.0, 193.0, 188.0, 142.0, 192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24816402438807736, "mean_inference_ms": 0.9715266389390718, "mean_action_processing_ms": 0.09925935134797916, "mean_env_wait_ms": 0.04053170151439338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981828689575195, "StateBufferConnector_ms": 0.0036802291870117188, "ViewRequirementAgentConnector_ms": 0.09919261932373047}, "num_episodes": 23, "episode_return_max": 376.0, "episode_return_min": 11.0, "episode_return_mean": 156.04, "episodes_this_iter": 23}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.41324026701784, "num_env_steps_trained_throughput_per_sec": 463.41324026701784, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8236.643, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8236.592, "sample_time_ms": 2784.166, "load_time_ms": 0.46, "load_throughput": 8701875.519, "learn_time_ms": 5446.334, "learn_throughput": 734.439, "synch_weights_time_ms": 5.139}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-48", "timestamp": 1731549888, "time_this_iter_s": 8.635329723358154, "time_total_s": 49.44589638710022, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.44589638710022, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.59166666666666, "ram_util_percent": 56.57500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.475411415100098, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.01, "total_loss": 9.083958793968282, "policy_loss": 0.021880692417823498, "vf_loss": 8.98094579891492, "vf_explained_var": 0.3118331440033451, "kl": 0.08013068221463923, "entropy": 0.4527442477723604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": 484.0, "episode_reward_min": 11.0, "episode_reward_mean": 177.07, "episode_len_mean": 177.07, "episode_media": {}, "episodes_timesteps_total": 17707, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 484.0}, "policy_reward_mean": {"default_policy": 177.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0, 220.0, 107.0, 163.0, 126.0, 170.0, 151.0, 228.0, 164.0, 149.0, 235.0, 354.0, 229.0, 193.0, 188.0, 142.0, 192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0, 175.0, 131.0, 484.0, 223.0, 224.0, 147.0, 287.0, 119.0, 133.0, 168.0, 209.0, 303.0, 157.0, 181.0, 378.0, 155.0, 220.0, 221.0], "episode_lengths": [11, 111, 150, 53, 111, 85, 91, 86, 184, 138, 55, 62, 206, 33, 138, 30, 164, 89, 237, 125, 173, 92, 298, 121, 209, 154, 177, 125, 205, 179, 237, 149, 84, 214, 130, 164, 172, 219, 168, 298, 146, 177, 199, 376, 143, 235, 189, 218, 94, 155, 251, 217, 302, 357, 116, 137, 192, 192, 161, 220, 107, 163, 126, 170, 151, 228, 164, 149, 235, 354, 229, 193, 188, 142, 192, 174, 200, 173, 137, 239, 140, 134, 175, 131, 484, 223, 224, 147, 287, 119, 133, 168, 209, 303, 157, 181, 378, 155, 220, 221], "policy_default_policy_reward": [11.0, 111.0, 150.0, 53.0, 111.0, 85.0, 91.0, 86.0, 184.0, 138.0, 55.0, 62.0, 206.0, 33.0, 138.0, 30.0, 164.0, 89.0, 237.0, 125.0, 173.0, 92.0, 298.0, 121.0, 209.0, 154.0, 177.0, 125.0, 205.0, 179.0, 237.0, 149.0, 84.0, 214.0, 130.0, 164.0, 172.0, 219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0, 220.0, 107.0, 163.0, 126.0, 170.0, 151.0, 228.0, 164.0, 149.0, 235.0, 354.0, 229.0, 193.0, 188.0, 142.0, 192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0, 175.0, 131.0, 484.0, 223.0, 224.0, 147.0, 287.0, 119.0, 133.0, 168.0, 209.0, 303.0, 157.0, 181.0, 378.0, 155.0, 220.0, 221.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24693631172330918, "mean_inference_ms": 0.9748218662008563, "mean_action_processing_ms": 0.09943867944697611, "mean_env_wait_ms": 0.04057435538056371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039675235748291016, "StateBufferConnector_ms": 0.0036737918853759766, "ViewRequirementAgentConnector_ms": 0.09939694404602051}, "num_episodes": 18, "episode_return_max": 484.0, "episode_return_min": 11.0, "episode_return_mean": 177.07, "episodes_this_iter": 18}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.8337072925596, "num_env_steps_trained_throughput_per_sec": 491.8337072925596, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8221.814, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8221.766, "sample_time_ms": 2791.665, "load_time_ms": 0.458, "load_throughput": 8724501.3, "learn_time_ms": 5424.007, "learn_throughput": 737.462, "synch_weights_time_ms": 5.155}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "b048f_00000", "date": "2024-11-14_02-04-56", "timestamp": 1731549896, "time_this_iter_s": 8.13726806640625, "time_total_s": 57.58316445350647, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.58316445350647, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.96666666666667, "ram_util_percent": 56.449999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.739212512969971, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.01, "total_loss": 8.965223395952615, "policy_loss": 0.019348343344585548, "vf_loss": 8.891869705979541, "vf_explained_var": 0.1973576683511016, "kl": 0.0355590800740601, "entropy": 0.4889347000788617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 484.0, "episode_reward_min": 19.0, "episode_reward_mean": 165.71, "episode_len_mean": 165.71, "episode_media": {}, "episodes_timesteps_total": 16571, "policy_reward_min": {"default_policy": 19.0}, "policy_reward_max": {"default_policy": 484.0}, "policy_reward_mean": {"default_policy": 165.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0, 220.0, 107.0, 163.0, 126.0, 170.0, 151.0, 228.0, 164.0, 149.0, 235.0, 354.0, 229.0, 193.0, 188.0, 142.0, 192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0, 175.0, 131.0, 484.0, 223.0, 224.0, 147.0, 287.0, 119.0, 133.0, 168.0, 209.0, 303.0, 157.0, 181.0, 378.0, 155.0, 220.0, 221.0, 243.0, 104.0, 126.0, 50.0, 77.0, 115.0, 107.0, 89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0], "episode_lengths": [219, 168, 298, 146, 177, 199, 376, 143, 235, 189, 218, 94, 155, 251, 217, 302, 357, 116, 137, 192, 192, 161, 220, 107, 163, 126, 170, 151, 228, 164, 149, 235, 354, 229, 193, 188, 142, 192, 174, 200, 173, 137, 239, 140, 134, 175, 131, 484, 223, 224, 147, 287, 119, 133, 168, 209, 303, 157, 181, 378, 155, 220, 221, 243, 104, 126, 50, 77, 115, 107, 89, 143, 68, 81, 118, 89, 82, 129, 89, 77, 19, 110, 118, 173, 229, 131, 90, 90, 69, 142, 70, 145, 71, 55, 189, 192, 64, 37, 39, 86], "policy_default_policy_reward": [219.0, 168.0, 298.0, 146.0, 177.0, 199.0, 376.0, 143.0, 235.0, 189.0, 218.0, 94.0, 155.0, 251.0, 217.0, 302.0, 357.0, 116.0, 137.0, 192.0, 192.0, 161.0, 220.0, 107.0, 163.0, 126.0, 170.0, 151.0, 228.0, 164.0, 149.0, 235.0, 354.0, 229.0, 193.0, 188.0, 142.0, 192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0, 175.0, 131.0, 484.0, 223.0, 224.0, 147.0, 287.0, 119.0, 133.0, 168.0, 209.0, 303.0, 157.0, 181.0, 378.0, 155.0, 220.0, 221.0, 243.0, 104.0, 126.0, 50.0, 77.0, 115.0, 107.0, 89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24383519450043065, "mean_inference_ms": 0.9776279854991315, "mean_action_processing_ms": 0.09927305464537223, "mean_env_wait_ms": 0.04050119237962326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003857851028442383, "StateBufferConnector_ms": 0.0036346912384033203, "ViewRequirementAgentConnector_ms": 0.09972381591796875}, "num_episodes": 37, "episode_return_max": 484.0, "episode_return_min": 19.0, "episode_return_mean": 165.71, "episodes_this_iter": 37}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.1698830255311, "num_env_steps_trained_throughput_per_sec": 467.1698830255311, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8264.362, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8264.317, "sample_time_ms": 2784.501, "load_time_ms": 0.445, "load_throughput": 8990403.108, "learn_time_ms": 5473.76, "learn_throughput": 730.759, "synch_weights_time_ms": 5.122}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-04", "timestamp": 1731549904, "time_this_iter_s": 8.56611680984497, "time_total_s": 66.14928126335144, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.14928126335144, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.483333333333334, "ram_util_percent": 56.63333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2431929111480713, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.01, "total_loss": 9.051011843835154, "policy_loss": -0.010573739336142618, "vf_loss": 9.048425553434639, "vf_explained_var": 0.8644027608697132, "kl": 0.005776697264463432, "entropy": 0.5025523070045697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 484.0, "episode_reward_min": 19.0, "episode_reward_mean": 133.2, "episode_len_mean": 133.2, "episode_media": {}, "episodes_timesteps_total": 13320, "policy_reward_min": {"default_policy": 19.0}, "policy_reward_max": {"default_policy": 484.0}, "policy_reward_mean": {"default_policy": 133.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0, 175.0, 131.0, 484.0, 223.0, 224.0, 147.0, 287.0, 119.0, 133.0, 168.0, 209.0, 303.0, 157.0, 181.0, 378.0, 155.0, 220.0, 221.0, 243.0, 104.0, 126.0, 50.0, 77.0, 115.0, 107.0, 89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0], "episode_lengths": [192, 174, 200, 173, 137, 239, 140, 134, 175, 131, 484, 223, 224, 147, 287, 119, 133, 168, 209, 303, 157, 181, 378, 155, 220, 221, 243, 104, 126, 50, 77, 115, 107, 89, 143, 68, 81, 118, 89, 82, 129, 89, 77, 19, 110, 118, 173, 229, 131, 90, 90, 69, 142, 70, 145, 71, 55, 189, 192, 64, 37, 39, 86, 129, 110, 135, 134, 161, 103, 105, 82, 90, 82, 114, 131, 99, 133, 96, 157, 83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124], "policy_default_policy_reward": [192.0, 174.0, 200.0, 173.0, 137.0, 239.0, 140.0, 134.0, 175.0, 131.0, 484.0, 223.0, 224.0, 147.0, 287.0, 119.0, 133.0, 168.0, 209.0, 303.0, 157.0, 181.0, 378.0, 155.0, 220.0, 221.0, 243.0, 104.0, 126.0, 50.0, 77.0, 115.0, 107.0, 89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2433455467548992, "mean_inference_ms": 0.9779220376732884, "mean_action_processing_ms": 0.09950142058520772, "mean_env_wait_ms": 0.0405693086079191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003854036331176758, "StateBufferConnector_ms": 0.0035886764526367188, "ViewRequirementAgentConnector_ms": 0.0999901294708252}, "num_episodes": 37, "episode_return_max": 484.0, "episode_return_min": 19.0, "episode_return_mean": 133.2, "episodes_this_iter": 37}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.6446193848531, "num_env_steps_trained_throughput_per_sec": 471.6446193848531, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8288.432, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8288.386, "sample_time_ms": 2778.734, "load_time_ms": 0.443, "load_throughput": 9023781.988, "learn_time_ms": 5503.608, "learn_throughput": 726.796, "synch_weights_time_ms": 5.116}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-13", "timestamp": 1731549913, "time_this_iter_s": 8.485780715942383, "time_total_s": 74.63506197929382, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 74.63506197929382, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.35, "ram_util_percent": 56.50833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0739448070526123, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.01, "total_loss": 9.841624506058231, "policy_loss": 0.015381979694469802, "vf_loss": 9.802510148222728, "vf_explained_var": 0.6458847639381244, "kl": 0.010417508024774588, "entropy": 0.476690550677238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 411.0, "episode_reward_min": 19.0, "episode_reward_mean": 124.57, "episode_len_mean": 124.57, "episode_media": {}, "episodes_timesteps_total": 12457, "policy_reward_min": {"default_policy": 19.0}, "policy_reward_max": {"default_policy": 411.0}, "policy_reward_mean": {"default_policy": 124.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.0, 221.0, 243.0, 104.0, 126.0, 50.0, 77.0, 115.0, 107.0, 89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0], "episode_lengths": [220, 221, 243, 104, 126, 50, 77, 115, 107, 89, 143, 68, 81, 118, 89, 82, 129, 89, 77, 19, 110, 118, 173, 229, 131, 90, 90, 69, 142, 70, 145, 71, 55, 189, 192, 64, 37, 39, 86, 129, 110, 135, 134, 161, 103, 105, 82, 90, 82, 114, 131, 99, 133, 96, 157, 83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60], "policy_default_policy_reward": [220.0, 221.0, 243.0, 104.0, 126.0, 50.0, 77.0, 115.0, 107.0, 89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2428043547589167, "mean_inference_ms": 0.9762214107208735, "mean_action_processing_ms": 0.0993692567795808, "mean_env_wait_ms": 0.040523593288680305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037674903869628906, "StateBufferConnector_ms": 0.003581523895263672, "ViewRequirementAgentConnector_ms": 0.10017251968383789}, "num_episodes": 24, "episode_return_max": 411.0, "episode_return_min": 19.0, "episode_return_mean": 124.57, "episodes_this_iter": 24}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.9763215453493, "num_env_steps_trained_throughput_per_sec": 477.9763215453493, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8296.451, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8296.407, "sample_time_ms": 2777.922, "load_time_ms": 0.44, "load_throughput": 9095313.889, "learn_time_ms": 5512.477, "learn_throughput": 725.627, "synch_weights_time_ms": 5.083}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-21", "timestamp": 1731549921, "time_this_iter_s": 8.372252941131592, "time_total_s": 83.00731492042542, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.00731492042542, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.84166666666666, "ram_util_percent": 56.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.590357780456543, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.01, "total_loss": 9.998233124004898, "policy_loss": 0.02157615062640479, "vf_loss": 9.842930279495896, "vf_explained_var": -0.3822987715403239, "kl": 0.05870032170558396, "entropy": 0.4380310013409584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 19.0, "episode_reward_mean": 145.41, "episode_len_mean": 145.41, "episode_media": {}, "episodes_timesteps_total": 14541, "policy_reward_min": {"default_policy": 19.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 145.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0], "episode_lengths": [89, 143, 68, 81, 118, 89, 82, 129, 89, 77, 19, 110, 118, 173, 229, 131, 90, 90, 69, 142, 70, 145, 71, 55, 189, 192, 64, 37, 39, 86, 129, 110, 135, 134, 161, 103, 105, 82, 90, 82, 114, 131, 99, 133, 96, 157, 83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500], "policy_default_policy_reward": [89.0, 143.0, 68.0, 81.0, 118.0, 89.0, 82.0, 129.0, 89.0, 77.0, 19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24287527687510888, "mean_inference_ms": 0.9767956353914158, "mean_action_processing_ms": 0.09952077187469609, "mean_env_wait_ms": 0.04056225724590938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003773927688598633, "StateBufferConnector_ms": 0.0036156177520751953, "ViewRequirementAgentConnector_ms": 0.10030364990234375}, "num_episodes": 9, "episode_return_max": 500.0, "episode_return_min": 19.0, "episode_return_mean": 145.41, "episodes_this_iter": 9}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.45658774780276, "num_env_steps_trained_throughput_per_sec": 475.45658774780276, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8312.793, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8312.753, "sample_time_ms": 2769.872, "load_time_ms": 0.451, "load_throughput": 8869794.343, "learn_time_ms": 5536.889, "learn_throughput": 722.427, "synch_weights_time_ms": 5.058}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-30", "timestamp": 1731549930, "time_this_iter_s": 8.416879653930664, "time_total_s": 91.42419457435608, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.42419457435608, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.59166666666666, "ram_util_percent": 52.69166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.816421031951904, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.01, "total_loss": 9.275840973854065, "policy_loss": 0.006575271991952773, "vf_loss": 9.203951323929653, "vf_explained_var": -0.4285650360968805, "kl": 0.019113499104625224, "entropy": 0.50165355276036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 19.0, "episode_reward_mean": 182.08, "episode_len_mean": 182.08, "episode_media": {}, "episodes_timesteps_total": 18208, "policy_reward_min": {"default_policy": 19.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 182.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0], "episode_lengths": [19, 110, 118, 173, 229, 131, 90, 90, 69, 142, 70, 145, 71, 55, 189, 192, 64, 37, 39, 86, 129, 110, 135, 134, 161, 103, 105, 82, 90, 82, 114, 131, 99, 133, 96, 157, 83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500, 500, 284, 500, 435, 500, 500, 500, 500, 500, 413], "policy_default_policy_reward": [19.0, 110.0, 118.0, 173.0, 229.0, 131.0, 90.0, 90.0, 69.0, 142.0, 70.0, 145.0, 71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2431364981785843, "mean_inference_ms": 0.9780667591639884, "mean_action_processing_ms": 0.09978119514163568, "mean_env_wait_ms": 0.04063176704155892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038628578186035156, "StateBufferConnector_ms": 0.0036211013793945312, "ViewRequirementAgentConnector_ms": 0.10058450698852539}, "num_episodes": 10, "episode_return_max": 500.0, "episode_return_min": 19.0, "episode_return_mean": 182.08, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.92416564155764, "num_env_steps_trained_throughput_per_sec": 485.92416564155764, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8333.049, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8333.01, "sample_time_ms": 2780.375, "load_time_ms": 0.45, "load_throughput": 8886707.982, "learn_time_ms": 5546.685, "learn_throughput": 721.152, "synch_weights_time_ms": 5.014}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-38", "timestamp": 1731549938, "time_this_iter_s": 8.23603630065918, "time_total_s": 99.66023087501526, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.66023087501526, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 56.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.952486515045166, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.01, "total_loss": 9.347075279810095, "policy_loss": 0.014902269514778289, "vf_loss": 9.241129682910058, "vf_explained_var": -0.04085365777374596, "kl": 0.026642774087994866, "entropy": 0.49201277497635093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 205.25, "episode_len_mean": 205.25, "episode_media": {}, "episodes_timesteps_total": 20525, "policy_reward_min": {"default_policy": 37.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 205.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0], "episode_lengths": [71, 55, 189, 192, 64, 37, 39, 86, 129, 110, 135, 134, 161, 103, 105, 82, 90, 82, 114, 131, 99, 133, 96, 157, 83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500, 500, 284, 500, 435, 500, 500, 500, 500, 500, 413, 456, 286, 399, 285, 298, 500, 333, 307, 163, 199, 282, 195], "policy_default_policy_reward": [71.0, 55.0, 189.0, 192.0, 64.0, 37.0, 39.0, 86.0, 129.0, 110.0, 135.0, 134.0, 161.0, 103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24274900651671472, "mean_inference_ms": 0.977520293193938, "mean_action_processing_ms": 0.09975049388228178, "mean_env_wait_ms": 0.04061648957731463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003798246383666992, "StateBufferConnector_ms": 0.0036215782165527344, "ViewRequirementAgentConnector_ms": 0.10068225860595703}, "num_episodes": 12, "episode_return_max": 500.0, "episode_return_min": 37.0, "episode_return_mean": 205.25, "episodes_this_iter": 12}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.0842702403871, "num_env_steps_trained_throughput_per_sec": 466.0842702403871, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 8379.229, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8379.192, "sample_time_ms": 2782.744, "load_time_ms": 0.428, "load_throughput": 9344035.645, "learn_time_ms": 5590.565, "learn_throughput": 715.491, "synch_weights_time_ms": 4.965}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-47", "timestamp": 1731549947, "time_this_iter_s": 8.585654258728027, "time_total_s": 108.24588513374329, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.24588513374329, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.85384615384615, "ram_util_percent": 56.684615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.913723945617676, "cur_kl_coeff": 5.12578125, "cur_lr": 0.01, "total_loss": 9.164112321023017, "policy_loss": 0.007862493628135292, "vf_loss": 9.049909589880256, "vf_explained_var": -0.11262838045756023, "kl": 0.020746154291437485, "entropy": 0.4804277922197055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 45.0, "episode_reward_mean": 232.21, "episode_len_mean": 232.21, "episode_media": {}, "episodes_timesteps_total": 23221, "policy_reward_min": {"default_policy": 45.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 232.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0], "episode_lengths": [103, 105, 82, 90, 82, 114, 131, 99, 133, 96, 157, 83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500, 500, 284, 500, 435, 500, 500, 500, 500, 500, 413, 456, 286, 399, 285, 298, 500, 333, 307, 163, 199, 282, 195, 500, 350, 365, 500, 305, 198, 226, 272, 179, 469, 202, 253, 279], "policy_default_policy_reward": [103.0, 105.0, 82.0, 90.0, 82.0, 114.0, 131.0, 99.0, 133.0, 96.0, 157.0, 83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24242868506646884, "mean_inference_ms": 0.9773510138005915, "mean_action_processing_ms": 0.09978958335609006, "mean_env_wait_ms": 0.04062022824079655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747224807739258, "StateBufferConnector_ms": 0.003623485565185547, "ViewRequirementAgentConnector_ms": 0.10072755813598633}, "num_episodes": 13, "episode_return_max": 500.0, "episode_return_min": 45.0, "episode_return_mean": 232.21, "episodes_this_iter": 13}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.1280890329874, "num_env_steps_trained_throughput_per_sec": 481.1280890329874, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 8400.457, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8400.42, "sample_time_ms": 2778.053, "load_time_ms": 0.425, "load_throughput": 9401634.071, "learn_time_ms": 5616.461, "learn_throughput": 712.192, "synch_weights_time_ms": 4.986}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "b048f_00000", "date": "2024-11-14_02-05-55", "timestamp": 1731549955, "time_this_iter_s": 8.3172767162323, "time_total_s": 116.56316184997559, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.56316184997559, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.07272727272727, "ram_util_percent": 56.63636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.246986389160156, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.01, "total_loss": 9.249120146997514, "policy_loss": 0.005780192262803515, "vf_loss": 8.856180464580495, "vf_explained_var": 0.007690349766003188, "kl": 0.050354535732218784, "entropy": 0.4841495168705781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 45.0, "episode_reward_mean": 263.02, "episode_len_mean": 263.02, "episode_media": {}, "episodes_timesteps_total": 26302, "policy_reward_min": {"default_policy": 45.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 263.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0, 500.0, 245.0, 259.0, 441.0, 337.0, 500.0, 414.0, 395.0, 239.0, 466.0, 477.0], "episode_lengths": [83, 192, 74, 77, 45, 110, 91, 130, 93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500, 500, 284, 500, 435, 500, 500, 500, 500, 500, 413, 456, 286, 399, 285, 298, 500, 333, 307, 163, 199, 282, 195, 500, 350, 365, 500, 305, 198, 226, 272, 179, 469, 202, 253, 279, 500, 245, 259, 441, 337, 500, 414, 395, 239, 466, 477], "policy_default_policy_reward": [83.0, 192.0, 74.0, 77.0, 45.0, 110.0, 91.0, 130.0, 93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0, 500.0, 245.0, 259.0, 441.0, 337.0, 500.0, 414.0, 395.0, 239.0, 466.0, 477.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24254827911541302, "mean_inference_ms": 0.9785081940906164, "mean_action_processing_ms": 0.100039199710866, "mean_env_wait_ms": 0.04068368529274121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037627220153808594, "StateBufferConnector_ms": 0.0036237239837646484, "ViewRequirementAgentConnector_ms": 0.10112524032592773}, "num_episodes": 11, "episode_return_max": 500.0, "episode_return_min": 45.0, "episode_return_mean": 263.02, "episodes_this_iter": 11}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.750597134352, "num_env_steps_trained_throughput_per_sec": 495.750597134352, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8378.553, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8378.516, "sample_time_ms": 2764.611, "load_time_ms": 0.44, "load_throughput": 9087431.481, "learn_time_ms": 5608.038, "learn_throughput": 713.262, "synch_weights_time_ms": 4.937}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "b048f_00000", "date": "2024-11-14_02-06-03", "timestamp": 1731549963, "time_this_iter_s": 8.0731041431427, "time_total_s": 124.63626599311829, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 124.63626599311829, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.31666666666666, "ram_util_percent": 56.57500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.3978214263916, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.01, "total_loss": 9.313589069551679, "policy_loss": 0.011868325962875318, "vf_loss": 8.766062031125509, "vf_explained_var": -0.43821019902024216, "kl": 0.04644570953652989, "entropy": 0.4650409428983606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 60.0, "episode_reward_mean": 289.72, "episode_len_mean": 289.72, "episode_media": {}, "episodes_timesteps_total": 28972, "policy_reward_min": {"default_policy": 60.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 289.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0, 500.0, 245.0, 259.0, 441.0, 337.0, 500.0, 414.0, 395.0, 239.0, 466.0, 477.0, 500.0, 500.0, 257.0, 500.0, 500.0, 500.0, 360.0, 355.0], "episode_lengths": [93, 105, 78, 90, 119, 132, 145, 82, 123, 119, 108, 129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500, 500, 284, 500, 435, 500, 500, 500, 500, 500, 413, 456, 286, 399, 285, 298, 500, 333, 307, 163, 199, 282, 195, 500, 350, 365, 500, 305, 198, 226, 272, 179, 469, 202, 253, 279, 500, 245, 259, 441, 337, 500, 414, 395, 239, 466, 477, 500, 500, 257, 500, 500, 500, 360, 355], "policy_default_policy_reward": [93.0, 105.0, 78.0, 90.0, 119.0, 132.0, 145.0, 82.0, 123.0, 119.0, 108.0, 129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0, 500.0, 245.0, 259.0, 441.0, 337.0, 500.0, 414.0, 395.0, 239.0, 466.0, 477.0, 500.0, 500.0, 257.0, 500.0, 500.0, 500.0, 360.0, 355.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24210406693907216, "mean_inference_ms": 0.9777170859760933, "mean_action_processing_ms": 0.0999460424206252, "mean_env_wait_ms": 0.04065202260094711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003731966018676758, "StateBufferConnector_ms": 0.003614664077758789, "ViewRequirementAgentConnector_ms": 0.10077333450317383}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 60.0, "episode_return_mean": 289.72, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.6800252738995, "num_env_steps_trained_throughput_per_sec": 496.6800252738995, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 8320.74, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8320.705, "sample_time_ms": 2760.539, "load_time_ms": 0.42, "load_throughput": 9516827.954, "learn_time_ms": 5554.254, "learn_throughput": 720.169, "synch_weights_time_ms": 4.987}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "b048f_00000", "date": "2024-11-14_02-06-11", "timestamp": 1731549971, "time_this_iter_s": 8.056526184082031, "time_total_s": 132.69279217720032, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.69279217720032, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.30833333333333, "ram_util_percent": 56.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.01416301727295, "cur_kl_coeff": 17.299511718750004, "cur_lr": 0.01, "total_loss": 9.878642073241613, "policy_loss": 0.0007836911366671644, "vf_loss": 9.739187403648131, "vf_explained_var": -0.4122304240862528, "kl": 0.008015889964072783, "entropy": 0.49217815379942614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 60.0, "episode_reward_mean": 323.34, "episode_len_mean": 323.34, "episode_media": {}, "episodes_timesteps_total": 32334, "policy_reward_min": {"default_policy": 60.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 323.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0, 500.0, 245.0, 259.0, 441.0, 337.0, 500.0, 414.0, 395.0, 239.0, 466.0, 477.0, 500.0, 500.0, 257.0, 500.0, 500.0, 500.0, 360.0, 355.0, 429.0, 418.0, 500.0, 500.0, 455.0, 478.0, 500.0, 500.0, 362.0, 274.0, 140.0], "episode_lengths": [129, 124, 190, 126, 112, 148, 69, 187, 202, 153, 188, 165, 121, 152, 142, 192, 325, 98, 166, 150, 203, 176, 411, 106, 158, 60, 346, 500, 500, 341, 162, 340, 500, 158, 500, 500, 284, 500, 435, 500, 500, 500, 500, 500, 413, 456, 286, 399, 285, 298, 500, 333, 307, 163, 199, 282, 195, 500, 350, 365, 500, 305, 198, 226, 272, 179, 469, 202, 253, 279, 500, 245, 259, 441, 337, 500, 414, 395, 239, 466, 477, 500, 500, 257, 500, 500, 500, 360, 355, 429, 418, 500, 500, 455, 478, 500, 500, 362, 274, 140], "policy_default_policy_reward": [129.0, 124.0, 190.0, 126.0, 112.0, 148.0, 69.0, 187.0, 202.0, 153.0, 188.0, 165.0, 121.0, 152.0, 142.0, 192.0, 325.0, 98.0, 166.0, 150.0, 203.0, 176.0, 411.0, 106.0, 158.0, 60.0, 346.0, 500.0, 500.0, 341.0, 162.0, 340.0, 500.0, 158.0, 500.0, 500.0, 284.0, 500.0, 435.0, 500.0, 500.0, 500.0, 500.0, 500.0, 413.0, 456.0, 286.0, 399.0, 285.0, 298.0, 500.0, 333.0, 307.0, 163.0, 199.0, 282.0, 195.0, 500.0, 350.0, 365.0, 500.0, 305.0, 198.0, 226.0, 272.0, 179.0, 469.0, 202.0, 253.0, 279.0, 500.0, 245.0, 259.0, 441.0, 337.0, 500.0, 414.0, 395.0, 239.0, 466.0, 477.0, 500.0, 500.0, 257.0, 500.0, 500.0, 500.0, 360.0, 355.0, 429.0, 418.0, 500.0, 500.0, 455.0, 478.0, 500.0, 500.0, 362.0, 274.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24139346969551198, "mean_inference_ms": 0.9763727424522353, "mean_action_processing_ms": 0.09978144336329113, "mean_env_wait_ms": 0.04059810199917895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037262439727783203, "StateBufferConnector_ms": 0.0036318302154541016, "ViewRequirementAgentConnector_ms": 0.10118985176086426}, "num_episodes": 11, "episode_return_max": 500.0, "episode_return_min": 60.0, "episode_return_mean": 323.34, "episodes_this_iter": 11}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.5227137468836, "num_env_steps_trained_throughput_per_sec": 483.5227137468836, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8334.719, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8334.685, "sample_time_ms": 2752.575, "load_time_ms": 0.417, "load_throughput": 9594656.296, "learn_time_ms": 5576.229, "learn_throughput": 717.331, "synch_weights_time_ms": 4.952}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": true, "training_iteration": 17, "trial_id": "b048f_00000", "date": "2024-11-14_02-06-19", "timestamp": 1731549979, "time_this_iter_s": 8.276396751403809, "time_total_s": 140.96918892860413, "pid": 9599, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.96918892860413, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.236363636363635, "ram_util_percent": 56.59090909090909}}
