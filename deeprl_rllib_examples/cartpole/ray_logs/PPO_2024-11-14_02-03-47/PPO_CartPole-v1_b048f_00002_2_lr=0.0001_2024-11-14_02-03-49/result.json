{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1212916374206543, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.739232806236513, "policy_loss": -0.04797286658237378, "vf_loss": 7.781172102753834, "vf_explained_var": 0.12096928031213822, "kl": 0.030167920003208826, "entropy": 0.6641499200174885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": 55.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.884615384615383, "episode_len_mean": 21.884615384615383, "episode_media": {}, "episodes_timesteps_total": 3983, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 55.0}, "policy_reward_mean": {"default_policy": 21.884615384615383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 17.0, 43.0, 35.0, 18.0, 9.0, 53.0, 40.0, 25.0, 10.0, 16.0, 15.0, 24.0, 34.0, 14.0, 19.0, 27.0, 16.0, 20.0, 49.0, 15.0, 15.0, 30.0, 10.0, 46.0, 28.0, 29.0, 50.0, 18.0, 49.0, 25.0, 28.0, 16.0, 37.0, 19.0, 14.0, 31.0, 28.0, 16.0, 20.0, 17.0, 14.0, 19.0, 15.0, 21.0, 13.0, 18.0, 55.0, 19.0, 14.0, 13.0, 17.0, 31.0, 18.0, 34.0, 34.0, 11.0, 14.0, 16.0, 20.0, 51.0, 26.0, 29.0, 17.0, 23.0, 15.0, 16.0, 19.0, 18.0, 42.0, 19.0, 23.0, 20.0, 18.0, 21.0, 22.0, 26.0, 13.0, 33.0, 21.0, 12.0, 21.0, 17.0, 13.0, 15.0, 14.0, 13.0, 19.0, 23.0, 23.0, 39.0, 24.0, 14.0, 40.0, 11.0, 17.0, 10.0, 20.0, 29.0, 45.0, 37.0, 11.0, 14.0, 10.0, 19.0, 14.0, 25.0, 12.0, 19.0, 24.0, 19.0, 16.0, 18.0, 9.0, 11.0, 26.0, 20.0, 13.0, 17.0, 30.0, 19.0, 21.0, 30.0, 18.0, 13.0, 20.0, 13.0, 22.0, 18.0, 38.0, 13.0, 17.0, 18.0, 14.0, 11.0, 11.0, 13.0, 53.0, 25.0, 29.0, 11.0, 12.0, 18.0, 22.0, 38.0, 15.0, 29.0, 15.0, 12.0, 50.0, 12.0, 21.0, 22.0, 26.0, 19.0, 18.0, 22.0, 17.0, 30.0, 15.0, 26.0, 21.0, 16.0, 28.0, 20.0, 10.0, 15.0, 11.0, 41.0, 37.0, 14.0, 16.0, 13.0, 35.0, 16.0, 9.0, 20.0, 23.0, 37.0, 16.0, 17.0, 11.0], "episode_lengths": [15, 17, 43, 35, 18, 9, 53, 40, 25, 10, 16, 15, 24, 34, 14, 19, 27, 16, 20, 49, 15, 15, 30, 10, 46, 28, 29, 50, 18, 49, 25, 28, 16, 37, 19, 14, 31, 28, 16, 20, 17, 14, 19, 15, 21, 13, 18, 55, 19, 14, 13, 17, 31, 18, 34, 34, 11, 14, 16, 20, 51, 26, 29, 17, 23, 15, 16, 19, 18, 42, 19, 23, 20, 18, 21, 22, 26, 13, 33, 21, 12, 21, 17, 13, 15, 14, 13, 19, 23, 23, 39, 24, 14, 40, 11, 17, 10, 20, 29, 45, 37, 11, 14, 10, 19, 14, 25, 12, 19, 24, 19, 16, 18, 9, 11, 26, 20, 13, 17, 30, 19, 21, 30, 18, 13, 20, 13, 22, 18, 38, 13, 17, 18, 14, 11, 11, 13, 53, 25, 29, 11, 12, 18, 22, 38, 15, 29, 15, 12, 50, 12, 21, 22, 26, 19, 18, 22, 17, 30, 15, 26, 21, 16, 28, 20, 10, 15, 11, 41, 37, 14, 16, 13, 35, 16, 9, 20, 23, 37, 16, 17, 11], "policy_default_policy_reward": [15.0, 17.0, 43.0, 35.0, 18.0, 9.0, 53.0, 40.0, 25.0, 10.0, 16.0, 15.0, 24.0, 34.0, 14.0, 19.0, 27.0, 16.0, 20.0, 49.0, 15.0, 15.0, 30.0, 10.0, 46.0, 28.0, 29.0, 50.0, 18.0, 49.0, 25.0, 28.0, 16.0, 37.0, 19.0, 14.0, 31.0, 28.0, 16.0, 20.0, 17.0, 14.0, 19.0, 15.0, 21.0, 13.0, 18.0, 55.0, 19.0, 14.0, 13.0, 17.0, 31.0, 18.0, 34.0, 34.0, 11.0, 14.0, 16.0, 20.0, 51.0, 26.0, 29.0, 17.0, 23.0, 15.0, 16.0, 19.0, 18.0, 42.0, 19.0, 23.0, 20.0, 18.0, 21.0, 22.0, 26.0, 13.0, 33.0, 21.0, 12.0, 21.0, 17.0, 13.0, 15.0, 14.0, 13.0, 19.0, 23.0, 23.0, 39.0, 24.0, 14.0, 40.0, 11.0, 17.0, 10.0, 20.0, 29.0, 45.0, 37.0, 11.0, 14.0, 10.0, 19.0, 14.0, 25.0, 12.0, 19.0, 24.0, 19.0, 16.0, 18.0, 9.0, 11.0, 26.0, 20.0, 13.0, 17.0, 30.0, 19.0, 21.0, 30.0, 18.0, 13.0, 20.0, 13.0, 22.0, 18.0, 38.0, 13.0, 17.0, 18.0, 14.0, 11.0, 11.0, 13.0, 53.0, 25.0, 29.0, 11.0, 12.0, 18.0, 22.0, 38.0, 15.0, 29.0, 15.0, 12.0, 50.0, 12.0, 21.0, 22.0, 26.0, 19.0, 18.0, 22.0, 17.0, 30.0, 15.0, 26.0, 21.0, 16.0, 28.0, 20.0, 10.0, 15.0, 11.0, 41.0, 37.0, 14.0, 16.0, 13.0, 35.0, 16.0, 9.0, 20.0, 23.0, 37.0, 16.0, 17.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28550857844024524, "mean_inference_ms": 1.0075864748871475, "mean_action_processing_ms": 0.10226580862945517, "mean_env_wait_ms": 0.0425977264510217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844434088403052, "StateBufferConnector_ms": 0.004086913643302498, "ViewRequirementAgentConnector_ms": 0.1061246945307805}, "num_episodes": 182, "episode_return_max": 55.0, "episode_return_min": 9.0, "episode_return_mean": 21.884615384615383, "episodes_this_iter": 182}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.1945224257343, "num_env_steps_trained_throughput_per_sec": 486.1945224257343, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8227.173, "restore_workers_time_ms": 0.027, "training_step_time_ms": 8227.085, "sample_time_ms": 2918.187, "load_time_ms": 0.46, "load_throughput": 8697364.438, "learn_time_ms": 5302.461, "learn_throughput": 754.367, "synch_weights_time_ms": 5.205}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "b048f_00002", "date": "2024-11-14_02-05-38", "timestamp": 1731549938, "time_this_iter_s": 8.232820272445679, "time_total_s": 8.232820272445679, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.232820272445679, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.51666666666667, "ram_util_percent": 56.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9683204889297485, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 8.204496834867744, "policy_loss": -0.03656547195728748, "vf_loss": 8.235202984656057, "vf_explained_var": 0.18139454940313934, "kl": 0.019531063876041196, "entropy": 0.6092832692848739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 191.0, "episode_reward_min": 9.0, "episode_reward_mean": 44.55, "episode_len_mean": 44.55, "episode_media": {}, "episodes_timesteps_total": 4455, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 191.0}, "policy_reward_mean": {"default_policy": 44.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 21.0, 16.0, 28.0, 20.0, 10.0, 15.0, 11.0, 41.0, 37.0, 14.0, 16.0, 13.0, 35.0, 16.0, 9.0, 20.0, 23.0, 37.0, 16.0, 17.0, 11.0, 16.0, 30.0, 22.0, 183.0, 59.0, 55.0, 64.0, 13.0, 178.0, 88.0, 38.0, 14.0, 167.0, 13.0, 91.0, 25.0, 12.0, 79.0, 34.0, 14.0, 48.0, 25.0, 36.0, 45.0, 62.0, 14.0, 11.0, 18.0, 49.0, 28.0, 94.0, 39.0, 137.0, 45.0, 45.0, 14.0, 39.0, 23.0, 26.0, 36.0, 88.0, 91.0, 132.0, 37.0, 15.0, 29.0, 13.0, 29.0, 107.0, 16.0, 15.0, 84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0], "episode_lengths": [26, 21, 16, 28, 20, 10, 15, 11, 41, 37, 14, 16, 13, 35, 16, 9, 20, 23, 37, 16, 17, 11, 16, 30, 22, 183, 59, 55, 64, 13, 178, 88, 38, 14, 167, 13, 91, 25, 12, 79, 34, 14, 48, 25, 36, 45, 62, 14, 11, 18, 49, 28, 94, 39, 137, 45, 45, 14, 39, 23, 26, 36, 88, 91, 132, 37, 15, 29, 13, 29, 107, 16, 15, 84, 74, 45, 26, 41, 38, 26, 66, 49, 191, 33, 38, 23, 134, 31, 60, 70, 41, 23, 28, 109, 19, 19, 21, 34, 24, 55], "policy_default_policy_reward": [26.0, 21.0, 16.0, 28.0, 20.0, 10.0, 15.0, 11.0, 41.0, 37.0, 14.0, 16.0, 13.0, 35.0, 16.0, 9.0, 20.0, 23.0, 37.0, 16.0, 17.0, 11.0, 16.0, 30.0, 22.0, 183.0, 59.0, 55.0, 64.0, 13.0, 178.0, 88.0, 38.0, 14.0, 167.0, 13.0, 91.0, 25.0, 12.0, 79.0, 34.0, 14.0, 48.0, 25.0, 36.0, 45.0, 62.0, 14.0, 11.0, 18.0, 49.0, 28.0, 94.0, 39.0, 137.0, 45.0, 45.0, 14.0, 39.0, 23.0, 26.0, 36.0, 88.0, 91.0, 132.0, 37.0, 15.0, 29.0, 13.0, 29.0, 107.0, 16.0, 15.0, 84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2729617642235221, "mean_inference_ms": 0.9930878096218209, "mean_action_processing_ms": 0.10105023631103119, "mean_env_wait_ms": 0.04200100537258344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038001537322998047, "StateBufferConnector_ms": 0.0039615631103515625, "ViewRequirementAgentConnector_ms": 0.10283327102661133}, "num_episodes": 78, "episode_return_max": 191.0, "episode_return_min": 9.0, "episode_return_mean": 44.55, "episodes_this_iter": 78}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.2017562126563, "num_env_steps_trained_throughput_per_sec": 467.2017562126563, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8394.398, "restore_workers_time_ms": 0.022, "training_step_time_ms": 8394.327, "sample_time_ms": 2844.252, "load_time_ms": 0.437, "load_throughput": 9147882.225, "learn_time_ms": 5543.814, "learn_throughput": 721.525, "synch_weights_time_ms": 5.2}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "b048f_00002", "date": "2024-11-14_02-05-47", "timestamp": 1731549947, "time_this_iter_s": 8.565944910049438, "time_total_s": 16.798765182495117, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.798765182495117, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.13076923076923, "ram_util_percent": 56.71538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6454063653945923, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 9.089287340000112, "policy_loss": -0.0236639816313982, "vf_loss": 9.109900030525782, "vf_explained_var": 0.14172992738344337, "kl": 0.010170973729986106, "entropy": 0.5600809248544837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 309.0, "episode_reward_min": 11.0, "episode_reward_mean": 68.84, "episode_len_mean": 68.84, "episode_media": {}, "episodes_timesteps_total": 6884, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 309.0}, "policy_reward_mean": {"default_policy": 68.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 91.0, 25.0, 12.0, 79.0, 34.0, 14.0, 48.0, 25.0, 36.0, 45.0, 62.0, 14.0, 11.0, 18.0, 49.0, 28.0, 94.0, 39.0, 137.0, 45.0, 45.0, 14.0, 39.0, 23.0, 26.0, 36.0, 88.0, 91.0, 132.0, 37.0, 15.0, 29.0, 13.0, 29.0, 107.0, 16.0, 15.0, 84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0], "episode_lengths": [13, 91, 25, 12, 79, 34, 14, 48, 25, 36, 45, 62, 14, 11, 18, 49, 28, 94, 39, 137, 45, 45, 14, 39, 23, 26, 36, 88, 91, 132, 37, 15, 29, 13, 29, 107, 16, 15, 84, 74, 45, 26, 41, 38, 26, 66, 49, 191, 33, 38, 23, 134, 31, 60, 70, 41, 23, 28, 109, 19, 19, 21, 34, 24, 55, 43, 54, 208, 108, 29, 68, 52, 115, 28, 66, 67, 141, 149, 71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78], "policy_default_policy_reward": [13.0, 91.0, 25.0, 12.0, 79.0, 34.0, 14.0, 48.0, 25.0, 36.0, 45.0, 62.0, 14.0, 11.0, 18.0, 49.0, 28.0, 94.0, 39.0, 137.0, 45.0, 45.0, 14.0, 39.0, 23.0, 26.0, 36.0, 88.0, 91.0, 132.0, 37.0, 15.0, 29.0, 13.0, 29.0, 107.0, 16.0, 15.0, 84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2655287561835838, "mean_inference_ms": 0.9868336430056666, "mean_action_processing_ms": 0.10070897166767658, "mean_env_wait_ms": 0.0418815669157065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038537979125976562, "StateBufferConnector_ms": 0.0038356781005859375, "ViewRequirementAgentConnector_ms": 0.10208415985107422}, "num_episodes": 35, "episode_return_max": 309.0, "episode_return_min": 11.0, "episode_return_mean": 68.84, "episodes_this_iter": 35}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.67086228997215, "num_env_steps_trained_throughput_per_sec": 491.67086228997215, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8308.111, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8308.05, "sample_time_ms": 2814.157, "load_time_ms": 0.408, "load_throughput": 9799775.701, "learn_time_ms": 5487.757, "learn_throughput": 728.895, "synch_weights_time_ms": 5.156}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "b048f_00002", "date": "2024-11-14_02-05-55", "timestamp": 1731549955, "time_this_iter_s": 8.139266014099121, "time_total_s": 24.93803119659424, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.93803119659424, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.77272727272727, "ram_util_percent": 56.63636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0535989999771118, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 9.58255455365745, "policy_loss": -0.014445059303875251, "vf_loss": 9.596071930341823, "vf_explained_var": 0.10015888957567112, "kl": 0.003092313437683047, "entropy": 0.5790113456787601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": 13.0, "episode_reward_mean": 98.85, "episode_len_mean": 98.85, "episode_media": {}, "episodes_timesteps_total": 9885, "policy_reward_min": {"default_policy": 13.0}, "policy_reward_max": {"default_policy": 335.0}, "policy_reward_mean": {"default_policy": 98.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 14.0, 39.0, 23.0, 26.0, 36.0, 88.0, 91.0, 132.0, 37.0, 15.0, 29.0, 13.0, 29.0, 107.0, 16.0, 15.0, 84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0], "episode_lengths": [45, 14, 39, 23, 26, 36, 88, 91, 132, 37, 15, 29, 13, 29, 107, 16, 15, 84, 74, 45, 26, 41, 38, 26, 66, 49, 191, 33, 38, 23, 134, 31, 60, 70, 41, 23, 28, 109, 19, 19, 21, 34, 24, 55, 43, 54, 208, 108, 29, 68, 52, 115, 28, 66, 67, 141, 149, 71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272], "policy_default_policy_reward": [45.0, 14.0, 39.0, 23.0, 26.0, 36.0, 88.0, 91.0, 132.0, 37.0, 15.0, 29.0, 13.0, 29.0, 107.0, 16.0, 15.0, 84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26340654461736457, "mean_inference_ms": 0.9859414093017483, "mean_action_processing_ms": 0.10063659758599312, "mean_env_wait_ms": 0.04177229023739502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038614273071289062, "StateBufferConnector_ms": 0.0038793087005615234, "ViewRequirementAgentConnector_ms": 0.10217976570129395}, "num_episodes": 21, "episode_return_max": 335.0, "episode_return_min": 13.0, "episode_return_mean": 98.85, "episodes_this_iter": 21}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.58643044018976, "num_env_steps_trained_throughput_per_sec": 493.58643044018976, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8257.073, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8257.02, "sample_time_ms": 2792.628, "load_time_ms": 0.453, "load_throughput": 8828951.98, "learn_time_ms": 5458.266, "learn_throughput": 732.834, "synch_weights_time_ms": 5.134}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-03", "timestamp": 1731549963, "time_this_iter_s": 8.108259201049805, "time_total_s": 33.04629039764404, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.04629039764404, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.32500000000001, "ram_util_percent": 56.56666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8166301846504211, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 9.685243748080346, "policy_loss": -0.020281535074595482, "vf_loss": 9.704009246826171, "vf_explained_var": 0.037467522903155255, "kl": 0.01010691068187089, "entropy": 0.5686686385062433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": 15.0, "episode_reward_mean": 131.75, "episode_len_mean": 131.75, "episode_media": {}, "episodes_timesteps_total": 13175, "policy_reward_min": {"default_policy": 15.0}, "policy_reward_max": {"default_policy": 371.0}, "policy_reward_mean": {"default_policy": 131.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0], "episode_lengths": [84, 74, 45, 26, 41, 38, 26, 66, 49, 191, 33, 38, 23, 134, 31, 60, 70, 41, 23, 28, 109, 19, 19, 21, 34, 24, 55, 43, 54, 208, 108, 29, 68, 52, 115, 28, 66, 67, 141, 149, 71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254], "policy_default_policy_reward": [84.0, 74.0, 45.0, 26.0, 41.0, 38.0, 26.0, 66.0, 49.0, 191.0, 33.0, 38.0, 23.0, 134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26014601797721537, "mean_inference_ms": 0.9859938314493689, "mean_action_processing_ms": 0.1005288520017449, "mean_env_wait_ms": 0.04170396273791506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003835916519165039, "StateBufferConnector_ms": 0.0038614273071289062, "ViewRequirementAgentConnector_ms": 0.10199379920959473}, "num_episodes": 17, "episode_return_max": 371.0, "episode_return_min": 15.0, "episode_return_mean": 131.75, "episodes_this_iter": 17}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.4143885384176, "num_env_steps_trained_throughput_per_sec": 490.4143885384176, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8236.934, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8236.885, "sample_time_ms": 2810.45, "load_time_ms": 0.44, "load_throughput": 9101234.675, "learn_time_ms": 5420.187, "learn_throughput": 737.982, "synch_weights_time_ms": 5.285}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-11", "timestamp": 1731549971, "time_this_iter_s": 8.161096811294556, "time_total_s": 41.2073872089386, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.2073872089386, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.054545454545455, "ram_util_percent": 56.64545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9443260431289673, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 9.664464732139342, "policy_loss": -0.019553056421379247, "vf_loss": 9.683180379354825, "vf_explained_var": -0.15382657807360414, "kl": 0.005582831871964203, "entropy": 0.53171197736776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 15.0, "episode_reward_mean": 161.34, "episode_len_mean": 161.34, "episode_media": {}, "episodes_timesteps_total": 16134, "policy_reward_min": {"default_policy": 15.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 161.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0], "episode_lengths": [134, 31, 60, 70, 41, 23, 28, 109, 19, 19, 21, 34, 24, 55, 43, 54, 208, 108, 29, 68, 52, 115, 28, 66, 67, 141, 149, 71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254, 454, 271, 308, 178, 268, 249, 244, 132, 123, 290, 340, 500, 336], "policy_default_policy_reward": [134.0, 31.0, 60.0, 70.0, 41.0, 23.0, 28.0, 109.0, 19.0, 19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25709822142432764, "mean_inference_ms": 0.9854024305130017, "mean_action_processing_ms": 0.10044516907324855, "mean_env_wait_ms": 0.0416553965646716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038826465606689453, "StateBufferConnector_ms": 0.003859281539916992, "ViewRequirementAgentConnector_ms": 0.10184478759765625}, "num_episodes": 13, "episode_return_max": 500.0, "episode_return_min": 15.0, "episode_return_mean": 161.34, "episodes_this_iter": 13}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.7477312282736, "num_env_steps_trained_throughput_per_sec": 488.7477312282736, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8228.143, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8228.098, "sample_time_ms": 2796.908, "load_time_ms": 0.428, "load_throughput": 9349242.686, "learn_time_ms": 5425.066, "learn_throughput": 737.318, "synch_weights_time_ms": 5.183}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-19", "timestamp": 1731549979, "time_this_iter_s": 8.18746304512024, "time_total_s": 49.39485025405884, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.39485025405884, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.36666666666667, "ram_util_percent": 56.583333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5681094527244568, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 9.819858328501384, "policy_loss": -0.025086750484932894, "vf_loss": 9.843876382356049, "vf_explained_var": -0.344238002966809, "kl": 0.007124626889551225, "entropy": 0.540224308320271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 15.0, "episode_reward_mean": 195.48, "episode_len_mean": 195.48, "episode_media": {}, "episodes_timesteps_total": 19548, "policy_reward_min": {"default_policy": 15.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 195.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0], "episode_lengths": [19, 21, 34, 24, 55, 43, 54, 208, 108, 29, 68, 52, 115, 28, 66, 67, 141, 149, 71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254, 454, 271, 308, 178, 268, 249, 244, 132, 123, 290, 340, 500, 336, 500, 500, 495, 464, 200, 500, 500, 270, 500], "policy_default_policy_reward": [19.0, 21.0, 34.0, 24.0, 55.0, 43.0, 54.0, 208.0, 108.0, 29.0, 68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2547819948345503, "mean_inference_ms": 0.9848831956228278, "mean_action_processing_ms": 0.10037792094036442, "mean_env_wait_ms": 0.04161650135967959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877401351928711, "StateBufferConnector_ms": 0.003854990005493164, "ViewRequirementAgentConnector_ms": 0.1012117862701416}, "num_episodes": 9, "episode_return_max": 500.0, "episode_return_min": 15.0, "episode_return_mean": 195.48, "episodes_this_iter": 9}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.8256562847545, "num_env_steps_trained_throughput_per_sec": 503.8256562847545, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8186.875, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8186.831, "sample_time_ms": 2791.844, "load_time_ms": 0.416, "load_throughput": 9626271.475, "learn_time_ms": 5388.926, "learn_throughput": 742.263, "synch_weights_time_ms": 5.146}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-27", "timestamp": 1731549987, "time_this_iter_s": 7.942556142807007, "time_total_s": 57.337406396865845, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.337406396865845, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.566666666666666, "ram_util_percent": 48.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6693581342697144, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 9.77896659502419, "policy_loss": -0.021215267511465217, "vf_loss": 9.799431738289453, "vf_explained_var": -0.3207928042898896, "kl": 0.005000931280453497, "entropy": 0.5074384537114892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 15.0, "episode_reward_mean": 230.96, "episode_len_mean": 230.96, "episode_media": {}, "episodes_timesteps_total": 23096, "policy_reward_min": {"default_policy": 15.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 230.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0], "episode_lengths": [68, 52, 115, 28, 66, 67, 141, 149, 71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254, 454, 271, 308, 178, 268, 249, 244, 132, 123, 290, 340, 500, 336, 500, 500, 495, 464, 200, 500, 500, 270, 500, 500, 193, 500, 500, 160, 500, 500, 374, 500, 416], "policy_default_policy_reward": [68.0, 52.0, 115.0, 28.0, 66.0, 67.0, 141.0, 149.0, 71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25285610450288876, "mean_inference_ms": 0.9848988201783462, "mean_action_processing_ms": 0.10033243929060888, "mean_env_wait_ms": 0.04157267307030007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038728713989257812, "StateBufferConnector_ms": 0.003869295120239258, "ViewRequirementAgentConnector_ms": 0.1012716293334961}, "num_episodes": 10, "episode_return_max": 500.0, "episode_return_min": 15.0, "episode_return_mean": 230.96, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.6692574103691, "num_env_steps_trained_throughput_per_sec": 506.6692574103691, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8150.353, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8150.312, "sample_time_ms": 2784.68, "load_time_ms": 0.409, "load_throughput": 9786199.635, "learn_time_ms": 5359.642, "learn_throughput": 746.318, "synch_weights_time_ms": 5.092}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-35", "timestamp": 1731549995, "time_this_iter_s": 7.897864103317261, "time_total_s": 65.2352705001831, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.2352705001831, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.972727272727273, "ram_util_percent": 48.89090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44477903842926025, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 9.851432133746403, "policy_loss": -0.020787476563966404, "vf_loss": 9.871758519449541, "vf_explained_var": -0.38136429812318534, "kl": 0.003074044543866438, "entropy": 0.522766710545427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 15.0, "episode_reward_mean": 262.78, "episode_len_mean": 262.78, "episode_media": {}, "episodes_timesteps_total": 26278, "policy_reward_min": {"default_policy": 15.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 262.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0, 500.0, 500.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [71, 212, 27, 94, 108, 159, 119, 173, 15, 100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254, 454, 271, 308, 178, 268, 249, 244, 132, 123, 290, 340, 500, 336, 500, 500, 495, 464, 200, 500, 500, 270, 500, 500, 193, 500, 500, 160, 500, 500, 374, 500, 416, 500, 500, 368, 500, 500, 500, 500, 500], "policy_default_policy_reward": [71.0, 212.0, 27.0, 94.0, 108.0, 159.0, 119.0, 173.0, 15.0, 100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0, 500.0, 500.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518202437401673, "mean_inference_ms": 0.9853153418645451, "mean_action_processing_ms": 0.10031031992874173, "mean_env_wait_ms": 0.041536285210660905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037794113159179688, "StateBufferConnector_ms": 0.0039038658142089844, "ViewRequirementAgentConnector_ms": 0.10122036933898926}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 15.0, "episode_return_mean": 262.78, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.9741259163908, "num_env_steps_trained_throughput_per_sec": 503.9741259163908, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8126.639, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8126.6, "sample_time_ms": 2776.421, "load_time_ms": 0.402, "load_throughput": 9951554.999, "learn_time_ms": 5344.234, "learn_throughput": 748.47, "synch_weights_time_ms": 5.064}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-43", "timestamp": 1731550003, "time_this_iter_s": 7.940162658691406, "time_total_s": 73.17543315887451, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.17543315887451, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.672727272727272, "ram_util_percent": 48.92727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4589969217777252, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 9.804045965338267, "policy_loss": -0.023713436137924912, "vf_loss": 9.827259174469978, "vf_explained_var": -0.438013683852329, "kl": 0.006669982216308229, "entropy": 0.53065690792376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 53.0, "episode_reward_mean": 294.2, "episode_len_mean": 294.2, "episode_media": {}, "episodes_timesteps_total": 29420, "policy_reward_min": {"default_policy": 53.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 294.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0, 500.0, 500.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 120.0], "episode_lengths": [100, 86, 142, 216, 159, 69, 53, 110, 85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254, 454, 271, 308, 178, 268, 249, 244, 132, 123, 290, 340, 500, 336, 500, 500, 495, 464, 200, 500, 500, 270, 500, 500, 193, 500, 500, 160, 500, 500, 374, 500, 416, 500, 500, 368, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 120], "policy_default_policy_reward": [100.0, 86.0, 142.0, 216.0, 159.0, 69.0, 53.0, 110.0, 85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0, 500.0, 500.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25048977287714536, "mean_inference_ms": 0.9855278556162493, "mean_action_processing_ms": 0.10027522802665643, "mean_env_wait_ms": 0.041494818542398934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670930862426758, "StateBufferConnector_ms": 0.00391077995300293, "ViewRequirementAgentConnector_ms": 0.10117125511169434}, "num_episodes": 9, "episode_return_max": 500.0, "episode_return_min": 53.0, "episode_return_mean": 294.2, "episodes_this_iter": 9}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.99416663006133, "num_env_steps_trained_throughput_per_sec": 500.99416663006133, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8112.388, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8112.35, "sample_time_ms": 2772.389, "load_time_ms": 0.398, "load_throughput": 10053461.17, "learn_time_ms": 5334.064, "learn_throughput": 749.897, "synch_weights_time_ms": 5.025}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-51", "timestamp": 1731550011, "time_this_iter_s": 7.9877238273620605, "time_total_s": 81.16315698623657, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.16315698623657, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.208333333333332, "ram_util_percent": 48.94166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47207963466644287, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 9.85878326149397, "policy_loss": -0.0260327621843786, "vf_loss": 9.88433172369516, "vf_explained_var": -0.38349761488617107, "kl": 0.006457542845905563, "entropy": 0.4845434533972894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 54.0, "episode_reward_mean": 324.85, "episode_len_mean": 324.85, "episode_media": {}, "episodes_timesteps_total": 32485, "policy_reward_min": {"default_policy": 54.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 324.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0, 500.0, 500.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 120.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [85, 136, 309, 159, 78, 224, 135, 267, 335, 195, 265, 64, 187, 226, 118, 195, 158, 54, 186, 204, 134, 225, 79, 253, 144, 272, 225, 264, 267, 310, 216, 241, 277, 145, 201, 108, 174, 333, 371, 167, 321, 171, 254, 454, 271, 308, 178, 268, 249, 244, 132, 123, 290, 340, 500, 336, 500, 500, 495, 464, 200, 500, 500, 270, 500, 500, 193, 500, 500, 160, 500, 500, 374, 500, 416, 500, 500, 368, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 120, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [85.0, 136.0, 309.0, 159.0, 78.0, 224.0, 135.0, 267.0, 335.0, 195.0, 265.0, 64.0, 187.0, 226.0, 118.0, 195.0, 158.0, 54.0, 186.0, 204.0, 134.0, 225.0, 79.0, 253.0, 144.0, 272.0, 225.0, 264.0, 267.0, 310.0, 216.0, 241.0, 277.0, 145.0, 201.0, 108.0, 174.0, 333.0, 371.0, 167.0, 321.0, 171.0, 254.0, 454.0, 271.0, 308.0, 178.0, 268.0, 249.0, 244.0, 132.0, 123.0, 290.0, 340.0, 500.0, 336.0, 500.0, 500.0, 495.0, 464.0, 200.0, 500.0, 500.0, 270.0, 500.0, 500.0, 193.0, 500.0, 500.0, 160.0, 500.0, 500.0, 374.0, 500.0, 416.0, 500.0, 500.0, 368.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 120.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24886591253486134, "mean_inference_ms": 0.984850665943357, "mean_action_processing_ms": 0.10018558508407083, "mean_env_wait_ms": 0.04145902564429019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036165714263916016, "StateBufferConnector_ms": 0.0038743019104003906, "ViewRequirementAgentConnector_ms": 0.10087847709655762}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 54.0, "episode_return_mean": 324.85, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.40296263624117, "num_env_steps_trained_throughput_per_sec": 511.40296263624117, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8071.834, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8071.802, "sample_time_ms": 2748.698, "load_time_ms": 0.386, "load_throughput": 10360783.054, "learn_time_ms": 5317.307, "learn_throughput": 752.26, "synch_weights_time_ms": 4.971}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": true, "training_iteration": 11, "trial_id": "b048f_00002", "date": "2024-11-14_02-06-59", "timestamp": 1731550019, "time_this_iter_s": 7.8249101638793945, "time_total_s": 88.98806715011597, "pid": 10542, "hostname": "ip-172-31-5-22", "node_ip": "172.31.5.22", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x797d6e816480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 88.98806715011597, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.818181818181817, "ram_util_percent": 49.027272727272724}}
