{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0586812496185303, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 7.976538396138017, "policy_loss": -0.04576603017587175, "vf_loss": 8.016752973166845, "vf_explained_var": 0.09250941834142132, "kl": 0.027757515053721246, "entropy": 0.6661777553378895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": 71.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.906077348066297, "episode_len_mean": 21.906077348066297, "episode_media": {}, "episodes_timesteps_total": 3965, "policy_reward_min": {"default_policy": 9.0}, "policy_reward_max": {"default_policy": 71.0}, "policy_reward_mean": {"default_policy": 21.906077348066297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 41.0, 9.0, 16.0, 11.0, 16.0, 13.0, 14.0, 14.0, 26.0, 30.0, 24.0, 15.0, 17.0, 18.0, 14.0, 24.0, 15.0, 30.0, 15.0, 15.0, 22.0, 22.0, 46.0, 26.0, 20.0, 15.0, 21.0, 12.0, 15.0, 60.0, 45.0, 17.0, 12.0, 17.0, 22.0, 17.0, 18.0, 24.0, 23.0, 14.0, 10.0, 19.0, 25.0, 23.0, 17.0, 9.0, 22.0, 11.0, 11.0, 44.0, 38.0, 17.0, 12.0, 33.0, 14.0, 10.0, 16.0, 12.0, 22.0, 15.0, 22.0, 29.0, 19.0, 27.0, 14.0, 32.0, 15.0, 26.0, 17.0, 28.0, 42.0, 17.0, 14.0, 20.0, 13.0, 46.0, 20.0, 38.0, 17.0, 15.0, 18.0, 23.0, 48.0, 14.0, 24.0, 20.0, 14.0, 18.0, 11.0, 16.0, 22.0, 12.0, 10.0, 12.0, 16.0, 13.0, 26.0, 17.0, 46.0, 15.0, 9.0, 18.0, 20.0, 22.0, 13.0, 51.0, 15.0, 34.0, 56.0, 21.0, 14.0, 43.0, 17.0, 25.0, 19.0, 14.0, 26.0, 22.0, 26.0, 20.0, 21.0, 71.0, 27.0, 15.0, 33.0, 13.0, 11.0, 18.0, 20.0, 30.0, 15.0, 22.0, 28.0, 9.0, 14.0, 14.0, 15.0, 45.0, 21.0, 21.0, 17.0, 18.0, 30.0, 9.0, 20.0, 13.0, 18.0, 43.0, 20.0, 20.0, 15.0, 22.0, 16.0, 18.0, 29.0, 42.0, 52.0, 48.0, 14.0, 20.0, 11.0, 21.0, 23.0, 28.0, 10.0, 33.0, 20.0, 25.0, 13.0, 10.0, 10.0, 19.0, 29.0, 13.0, 17.0, 23.0, 20.0, 27.0, 30.0, 37.0], "episode_lengths": [23, 41, 9, 16, 11, 16, 13, 14, 14, 26, 30, 24, 15, 17, 18, 14, 24, 15, 30, 15, 15, 22, 22, 46, 26, 20, 15, 21, 12, 15, 60, 45, 17, 12, 17, 22, 17, 18, 24, 23, 14, 10, 19, 25, 23, 17, 9, 22, 11, 11, 44, 38, 17, 12, 33, 14, 10, 16, 12, 22, 15, 22, 29, 19, 27, 14, 32, 15, 26, 17, 28, 42, 17, 14, 20, 13, 46, 20, 38, 17, 15, 18, 23, 48, 14, 24, 20, 14, 18, 11, 16, 22, 12, 10, 12, 16, 13, 26, 17, 46, 15, 9, 18, 20, 22, 13, 51, 15, 34, 56, 21, 14, 43, 17, 25, 19, 14, 26, 22, 26, 20, 21, 71, 27, 15, 33, 13, 11, 18, 20, 30, 15, 22, 28, 9, 14, 14, 15, 45, 21, 21, 17, 18, 30, 9, 20, 13, 18, 43, 20, 20, 15, 22, 16, 18, 29, 42, 52, 48, 14, 20, 11, 21, 23, 28, 10, 33, 20, 25, 13, 10, 10, 19, 29, 13, 17, 23, 20, 27, 30, 37], "policy_default_policy_reward": [23.0, 41.0, 9.0, 16.0, 11.0, 16.0, 13.0, 14.0, 14.0, 26.0, 30.0, 24.0, 15.0, 17.0, 18.0, 14.0, 24.0, 15.0, 30.0, 15.0, 15.0, 22.0, 22.0, 46.0, 26.0, 20.0, 15.0, 21.0, 12.0, 15.0, 60.0, 45.0, 17.0, 12.0, 17.0, 22.0, 17.0, 18.0, 24.0, 23.0, 14.0, 10.0, 19.0, 25.0, 23.0, 17.0, 9.0, 22.0, 11.0, 11.0, 44.0, 38.0, 17.0, 12.0, 33.0, 14.0, 10.0, 16.0, 12.0, 22.0, 15.0, 22.0, 29.0, 19.0, 27.0, 14.0, 32.0, 15.0, 26.0, 17.0, 28.0, 42.0, 17.0, 14.0, 20.0, 13.0, 46.0, 20.0, 38.0, 17.0, 15.0, 18.0, 23.0, 48.0, 14.0, 24.0, 20.0, 14.0, 18.0, 11.0, 16.0, 22.0, 12.0, 10.0, 12.0, 16.0, 13.0, 26.0, 17.0, 46.0, 15.0, 9.0, 18.0, 20.0, 22.0, 13.0, 51.0, 15.0, 34.0, 56.0, 21.0, 14.0, 43.0, 17.0, 25.0, 19.0, 14.0, 26.0, 22.0, 26.0, 20.0, 21.0, 71.0, 27.0, 15.0, 33.0, 13.0, 11.0, 18.0, 20.0, 30.0, 15.0, 22.0, 28.0, 9.0, 14.0, 14.0, 15.0, 45.0, 21.0, 21.0, 17.0, 18.0, 30.0, 9.0, 20.0, 13.0, 18.0, 43.0, 20.0, 20.0, 15.0, 22.0, 16.0, 18.0, 29.0, 42.0, 52.0, 48.0, 14.0, 20.0, 11.0, 21.0, 23.0, 28.0, 10.0, 33.0, 20.0, 25.0, 13.0, 10.0, 10.0, 19.0, 29.0, 13.0, 17.0, 23.0, 20.0, 27.0, 30.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2751219930603014, "mean_inference_ms": 0.9660405348348521, "mean_action_processing_ms": 0.09976047569680045, "mean_env_wait_ms": 0.04199579018713462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00408841760119022, "StateBufferConnector_ms": 0.003844730103213484, "ViewRequirementAgentConnector_ms": 0.10463361582044739}, "num_episodes": 181, "episode_return_max": 71.0, "episode_return_min": 9.0, "episode_return_mean": 21.906077348066297, "episodes_this_iter": 181}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.6856054947162, "num_env_steps_trained_throughput_per_sec": 486.6856054947162, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8218.867, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8218.811, "sample_time_ms": 2815.498, "load_time_ms": 0.266, "load_throughput": 15046830.493, "learn_time_ms": 5397.476, "learn_throughput": 741.087, "synch_weights_time_ms": 4.938}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "08dc1_00002", "date": "2024-11-15_06-44-34", "timestamp": 1731653074, "time_this_iter_s": 8.224342346191406, "time_total_s": 8.224342346191406, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.224342346191406, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.675, "ram_util_percent": 31.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0535168647766113, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 8.399862874964231, "policy_loss": -0.03206028047828905, "vf_loss": 8.426398387519262, "vf_explained_var": 0.15955167182030217, "kl": 0.018415877852093344, "entropy": 0.6053797083516275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 248.0, "episode_reward_min": 10.0, "episode_reward_mean": 46.47, "episode_len_mean": 46.47, "episode_media": {}, "episodes_timesteps_total": 4647, "policy_reward_min": {"default_policy": 10.0}, "policy_reward_max": {"default_policy": 248.0}, "policy_reward_mean": {"default_policy": 46.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 18.0, 29.0, 42.0, 52.0, 48.0, 14.0, 20.0, 11.0, 21.0, 23.0, 28.0, 10.0, 33.0, 20.0, 25.0, 13.0, 10.0, 10.0, 19.0, 29.0, 13.0, 17.0, 23.0, 20.0, 27.0, 30.0, 37.0, 63.0, 25.0, 39.0, 22.0, 23.0, 29.0, 21.0, 16.0, 82.0, 31.0, 141.0, 123.0, 26.0, 17.0, 13.0, 38.0, 68.0, 35.0, 56.0, 88.0, 24.0, 51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0], "episode_lengths": [16, 18, 29, 42, 52, 48, 14, 20, 11, 21, 23, 28, 10, 33, 20, 25, 13, 10, 10, 19, 29, 13, 17, 23, 20, 27, 30, 37, 63, 25, 39, 22, 23, 29, 21, 16, 82, 31, 141, 123, 26, 17, 13, 38, 68, 35, 56, 88, 24, 51, 28, 49, 36, 69, 33, 11, 20, 45, 248, 35, 15, 112, 50, 32, 51, 25, 35, 25, 12, 49, 78, 175, 87, 97, 86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133], "policy_default_policy_reward": [16.0, 18.0, 29.0, 42.0, 52.0, 48.0, 14.0, 20.0, 11.0, 21.0, 23.0, 28.0, 10.0, 33.0, 20.0, 25.0, 13.0, 10.0, 10.0, 19.0, 29.0, 13.0, 17.0, 23.0, 20.0, 27.0, 30.0, 37.0, 63.0, 25.0, 39.0, 22.0, 23.0, 29.0, 21.0, 16.0, 82.0, 31.0, 141.0, 123.0, 26.0, 17.0, 13.0, 38.0, 68.0, 35.0, 56.0, 88.0, 24.0, 51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2686913574145956, "mean_inference_ms": 0.9685725617644684, "mean_action_processing_ms": 0.10050547111309861, "mean_env_wait_ms": 0.04216501505611088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042362213134765625, "StateBufferConnector_ms": 0.003849506378173828, "ViewRequirementAgentConnector_ms": 0.10580706596374512}, "num_episodes": 72, "episode_return_max": 248.0, "episode_return_min": 10.0, "episode_return_mean": 46.47, "episodes_this_iter": 72}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.86195418757967, "num_env_steps_trained_throughput_per_sec": 495.86195418757967, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8142.82, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8142.768, "sample_time_ms": 2804.028, "load_time_ms": 0.327, "load_throughput": 12237210.795, "learn_time_ms": 5333.141, "learn_throughput": 750.027, "synch_weights_time_ms": 4.733}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "08dc1_00002", "date": "2024-11-15_06-44-42", "timestamp": 1731653082, "time_this_iter_s": 8.071042776107788, "time_total_s": 16.295385122299194, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.295385122299194, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.741666666666664, "ram_util_percent": 31.358333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.13865065574646, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 9.538756001380182, "policy_loss": -0.023664212867777836, "vf_loss": 9.559753570761732, "vf_explained_var": 0.05172216424378016, "kl": 0.008888786335448826, "entropy": 0.5627564715441837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 404.0, "episode_reward_min": 11.0, "episode_reward_mean": 78.49, "episode_len_mean": 78.49, "episode_media": {}, "episodes_timesteps_total": 7849, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 404.0}, "policy_reward_mean": {"default_policy": 78.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 23.0, 20.0, 27.0, 30.0, 37.0, 63.0, 25.0, 39.0, 22.0, 23.0, 29.0, 21.0, 16.0, 82.0, 31.0, 141.0, 123.0, 26.0, 17.0, 13.0, 38.0, 68.0, 35.0, 56.0, 88.0, 24.0, 51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0], "episode_lengths": [17, 23, 20, 27, 30, 37, 63, 25, 39, 22, 23, 29, 21, 16, 82, 31, 141, 123, 26, 17, 13, 38, 68, 35, 56, 88, 24, 51, 28, 49, 36, 69, 33, 11, 20, 45, 248, 35, 15, 112, 50, 32, 51, 25, 35, 25, 12, 49, 78, 175, 87, 97, 86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159], "policy_default_policy_reward": [17.0, 23.0, 20.0, 27.0, 30.0, 37.0, 63.0, 25.0, 39.0, 22.0, 23.0, 29.0, 21.0, 16.0, 82.0, 31.0, 141.0, 123.0, 26.0, 17.0, 13.0, 38.0, 68.0, 35.0, 56.0, 88.0, 24.0, 51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2648276859917057, "mean_inference_ms": 0.9707854195126141, "mean_action_processing_ms": 0.10050859845061097, "mean_env_wait_ms": 0.04220678380126088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004174709320068359, "StateBufferConnector_ms": 0.003881216049194336, "ViewRequirementAgentConnector_ms": 0.10495710372924805}, "num_episodes": 22, "episode_return_max": 404.0, "episode_return_min": 11.0, "episode_return_mean": 78.49, "episodes_this_iter": 22}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.18566334513605, "num_env_steps_trained_throughput_per_sec": 502.18566334513605, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8083.61, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8083.559, "sample_time_ms": 2768.298, "load_time_ms": 0.336, "load_throughput": 11909997.16, "learn_time_ms": 5309.58, "learn_throughput": 753.355, "synch_weights_time_ms": 4.832}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "08dc1_00002", "date": "2024-11-15_06-44-50", "timestamp": 1731653090, "time_this_iter_s": 7.968552350997925, "time_total_s": 24.26393747329712, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.26393747329712, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.736363636363627, "ram_util_percent": 31.236363636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7766925692558289, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 9.642688293867213, "policy_loss": -0.020053761810945567, "vf_loss": 9.661053767255558, "vf_explained_var": 0.13238671229731652, "kl": 0.005627734389717783, "entropy": 0.5346243110395247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 410.0, "episode_reward_min": 11.0, "episode_reward_mean": 114.48, "episode_len_mean": 114.48, "episode_media": {}, "episodes_timesteps_total": 11448, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 410.0}, "policy_reward_mean": {"default_policy": 114.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.0, 26.0, 17.0, 13.0, 38.0, 68.0, 35.0, 56.0, 88.0, 24.0, 51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0], "episode_lengths": [123, 26, 17, 13, 38, 68, 35, 56, 88, 24, 51, 28, 49, 36, 69, 33, 11, 20, 45, 248, 35, 15, 112, 50, 32, 51, 25, 35, 25, 12, 49, 78, 175, 87, 97, 86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327], "policy_default_policy_reward": [123.0, 26.0, 17.0, 13.0, 38.0, 68.0, 35.0, 56.0, 88.0, 24.0, 51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26173553071789807, "mean_inference_ms": 0.9695503523506624, "mean_action_processing_ms": 0.10042340310158827, "mean_env_wait_ms": 0.04216046933386235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004015922546386719, "StateBufferConnector_ms": 0.003896474838256836, "ViewRequirementAgentConnector_ms": 0.1039423942565918}, "num_episodes": 17, "episode_return_max": 410.0, "episode_return_min": 11.0, "episode_return_mean": 114.48, "episodes_this_iter": 17}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.22690802070736, "num_env_steps_trained_throughput_per_sec": 492.22690802070736, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8094.293, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8094.248, "sample_time_ms": 2748.2, "load_time_ms": 0.395, "load_throughput": 10129639.849, "learn_time_ms": 5340.259, "learn_throughput": 749.027, "synch_weights_time_ms": 4.9}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "08dc1_00002", "date": "2024-11-15_06-44-58", "timestamp": 1731653098, "time_this_iter_s": 8.129514217376709, "time_total_s": 32.39345169067383, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.39345169067383, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.70833333333334, "ram_util_percent": 31.466666666666658}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6073276400566101, "cur_kl_coeff": 0.3, "cur_lr": 0.00010000000000000003, "total_loss": 9.805332266899848, "policy_loss": -0.019832976775303962, "vf_loss": 9.823759466601956, "vf_explained_var": -0.02054201537562955, "kl": 0.004685855580909035, "entropy": 0.5353155800091323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 11.0, "episode_reward_mean": 147.76, "episode_len_mean": 147.76, "episode_media": {}, "episodes_timesteps_total": 14776, "policy_reward_min": {"default_policy": 11.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 147.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0], "episode_lengths": [51, 28, 49, 36, 69, 33, 11, 20, 45, 248, 35, 15, 112, 50, 32, 51, 25, 35, 25, 12, 49, 78, 175, 87, 97, 86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327, 393, 318, 344, 417, 415, 264, 500, 427, 369, 369], "policy_default_policy_reward": [51.0, 28.0, 49.0, 36.0, 69.0, 33.0, 11.0, 20.0, 45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2598259437571924, "mean_inference_ms": 0.9692324298471567, "mean_action_processing_ms": 0.10035619093836246, "mean_env_wait_ms": 0.04210649409724442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039141178131103516, "StateBufferConnector_ms": 0.0038645267486572266, "ViewRequirementAgentConnector_ms": 0.10342812538146973}, "num_episodes": 10, "episode_return_max": 500.0, "episode_return_min": 11.0, "episode_return_mean": 147.76, "episodes_this_iter": 10}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.94732683378135, "num_env_steps_trained_throughput_per_sec": 486.94732683378135, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8118.324, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8118.282, "sample_time_ms": 2764.015, "load_time_ms": 0.396, "load_throughput": 10103104.902, "learn_time_ms": 5348.449, "learn_throughput": 747.88, "synch_weights_time_ms": 4.943}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "08dc1_00002", "date": "2024-11-15_06-45-06", "timestamp": 1731653106, "time_this_iter_s": 8.21762466430664, "time_total_s": 40.61107635498047, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.61107635498047, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.933333333333337, "ram_util_percent": 31.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5804546475410461, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 9.87018388420023, "policy_loss": -0.022639606828971575, "vf_loss": 9.892126851440757, "vf_explained_var": -0.24540863671610433, "kl": 0.00464421324856939, "entropy": 0.5104549594463841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 184.34, "episode_len_mean": 184.34, "episode_media": {}, "episodes_timesteps_total": 18434, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 184.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0], "episode_lengths": [45, 248, 35, 15, 112, 50, 32, 51, 25, 35, 25, 12, 49, 78, 175, 87, 97, 86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327, 393, 318, 344, 417, 415, 264, 500, 427, 369, 369, 500, 500, 500, 500, 455, 500, 500, 500], "policy_default_policy_reward": [45.0, 248.0, 35.0, 15.0, 112.0, 50.0, 32.0, 51.0, 25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2581674631605755, "mean_inference_ms": 0.9689110038614672, "mean_action_processing_ms": 0.10030536402856885, "mean_env_wait_ms": 0.04206266953958289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003857851028442383, "StateBufferConnector_ms": 0.003874063491821289, "ViewRequirementAgentConnector_ms": 0.10322928428649902}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 184.34, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.55327707886033, "num_env_steps_trained_throughput_per_sec": 489.55327707886033, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8127.058, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8127.017, "sample_time_ms": 2759.599, "load_time_ms": 0.394, "load_throughput": 10153650.999, "learn_time_ms": 5361.675, "learn_throughput": 746.036, "synch_weights_time_ms": 4.875}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "08dc1_00002", "date": "2024-11-15_06-45-14", "timestamp": 1731653114, "time_this_iter_s": 8.173972129821777, "time_total_s": 48.785048484802246, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.785048484802246, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.58181818181818, "ram_util_percent": 31.25454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4959220588207245, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 9.865927648031583, "policy_loss": -0.022946066565571292, "vf_loss": 9.888349517699211, "vf_explained_var": -0.18334210771386342, "kl": 0.006989127596516137, "entropy": 0.5163869686024163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 215.08, "episode_len_mean": 215.08, "episode_media": {}, "episodes_timesteps_total": 21508, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 215.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0], "episode_lengths": [25, 35, 25, 12, 49, 78, 175, 87, 97, 86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327, 393, 318, 344, 417, 415, 264, 500, 427, 369, 369, 500, 500, 500, 500, 455, 500, 500, 500, 354, 500, 500, 500, 309, 499, 500, 500], "policy_default_policy_reward": [25.0, 35.0, 25.0, 12.0, 49.0, 78.0, 175.0, 87.0, 97.0, 86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25638607633314836, "mean_inference_ms": 0.9683869754627207, "mean_action_processing_ms": 0.10025226895268353, "mean_env_wait_ms": 0.04201413434658212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038840770721435547, "StateBufferConnector_ms": 0.003860950469970703, "ViewRequirementAgentConnector_ms": 0.10296940803527832}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 215.08, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.8680552433345, "num_env_steps_trained_throughput_per_sec": 499.8680552433345, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8109.21, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8109.171, "sample_time_ms": 2750.387, "load_time_ms": 0.391, "load_throughput": 10232683.802, "learn_time_ms": 5353.082, "learn_throughput": 747.233, "synch_weights_time_ms": 4.842}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "08dc1_00002", "date": "2024-11-15_06-45-22", "timestamp": 1731653122, "time_this_iter_s": 8.005203247070312, "time_total_s": 56.79025173187256, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.79025173187256, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.316666666666674, "ram_util_percent": 31.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.635532021522522, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 9.842202139413486, "policy_loss": -0.019580953325875984, "vf_loss": 9.861309849318637, "vf_explained_var": -0.15843027323804876, "kl": 0.006310051453117425, "entropy": 0.5137838041269651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 251.02, "episode_len_mean": 251.02, "episode_media": {}, "episodes_timesteps_total": 25102, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 251.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0, 500.0, 497.0, 450.0, 500.0, 457.0, 471.0, 302.0, 500.0, 500.0], "episode_lengths": [86, 56, 29, 96, 139, 98, 27, 139, 44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327, 393, 318, 344, 417, 415, 264, 500, 427, 369, 369, 500, 500, 500, 500, 455, 500, 500, 500, 354, 500, 500, 500, 309, 499, 500, 500, 500, 497, 450, 500, 457, 471, 302, 500, 500], "policy_default_policy_reward": [86.0, 56.0, 29.0, 96.0, 139.0, 98.0, 27.0, 139.0, 44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0, 500.0, 497.0, 450.0, 500.0, 457.0, 471.0, 302.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25433019511378896, "mean_inference_ms": 0.9679606336154069, "mean_action_processing_ms": 0.10015820164568882, "mean_env_wait_ms": 0.04195715562649257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003827810287475586, "StateBufferConnector_ms": 0.003854513168334961, "ViewRequirementAgentConnector_ms": 0.10283160209655762}, "num_episodes": 9, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 251.02, "episodes_this_iter": 9}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.3392238988312, "num_env_steps_trained_throughput_per_sec": 506.3392238988312, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8083.04, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8083.002, "sample_time_ms": 2740.973, "load_time_ms": 0.393, "load_throughput": 10185757.608, "learn_time_ms": 5336.352, "learn_throughput": 749.576, "synch_weights_time_ms": 4.821}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "08dc1_00002", "date": "2024-11-15_06-45-30", "timestamp": 1731653130, "time_this_iter_s": 7.902982711791992, "time_total_s": 64.69323444366455, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.69323444366455, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.172727272727272, "ram_util_percent": 31.245454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5083598494529724, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 9.851833247112971, "policy_loss": -0.022406957014113344, "vf_loss": 9.87376439904654, "vf_explained_var": -0.21629707819672042, "kl": 0.006344168890881151, "entropy": 0.512626969718164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 12.0, "episode_reward_mean": 284.32, "episode_len_mean": 284.32, "episode_media": {}, "episodes_timesteps_total": 28432, "policy_reward_min": {"default_policy": 12.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 284.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0, 500.0, 497.0, 450.0, 500.0, 457.0, 471.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [44, 35, 56, 57, 34, 12, 66, 32, 22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327, 393, 318, 344, 417, 415, 264, 500, 427, 369, 369, 500, 500, 500, 500, 455, 500, 500, 500, 354, 500, 500, 500, 309, 499, 500, 500, 500, 497, 450, 500, 457, 471, 302, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [44.0, 35.0, 56.0, 57.0, 34.0, 12.0, 66.0, 32.0, 22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0, 500.0, 497.0, 450.0, 500.0, 457.0, 471.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25248959334633464, "mean_inference_ms": 0.9680087729124406, "mean_action_processing_ms": 0.1000381364717187, "mean_env_wait_ms": 0.041907225868123614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037908554077148438, "StateBufferConnector_ms": 0.003818511962890625, "ViewRequirementAgentConnector_ms": 0.10209226608276367}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 12.0, "episode_return_mean": 284.32, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.3178323067164, "num_env_steps_trained_throughput_per_sec": 497.3178323067164, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8078.608, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8078.571, "sample_time_ms": 2737.69, "load_time_ms": 0.388, "load_throughput": 10306118.627, "learn_time_ms": 5335.254, "learn_throughput": 749.73, "synch_weights_time_ms": 4.781}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "08dc1_00002", "date": "2024-11-15_06-45-38", "timestamp": 1731653138, "time_this_iter_s": 8.046449422836304, "time_total_s": 72.73968386650085, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72.73968386650085, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.141666666666666, "ram_util_percent": 31.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3658175468444824, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 9.847103348598685, "policy_loss": -0.020812478461252747, "vf_loss": 9.867646005076747, "vf_explained_var": -0.27539548655991913, "kl": 0.003597630715458987, "entropy": 0.4934272216212365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 320.96, "episode_len_mean": 320.96, "episode_media": {}, "episodes_timesteps_total": 32096, "policy_reward_min": {"default_policy": 14.0}, "policy_reward_max": {"default_policy": 500.0}, "policy_reward_mean": {"default_policy": 320.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0, 500.0, 497.0, 450.0, 500.0, 457.0, 471.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [22, 14, 17, 139, 75, 36, 25, 25, 49, 133, 29, 349, 400, 151, 145, 59, 169, 53, 133, 190, 66, 174, 404, 289, 37, 150, 182, 27, 144, 154, 242, 159, 270, 336, 183, 381, 359, 268, 148, 124, 90, 68, 151, 410, 309, 190, 271, 360, 327, 393, 318, 344, 417, 415, 264, 500, 427, 369, 369, 500, 500, 500, 500, 455, 500, 500, 500, 354, 500, 500, 500, 309, 499, 500, 500, 500, 497, 450, 500, 457, 471, 302, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_default_policy_reward": [22.0, 14.0, 17.0, 139.0, 75.0, 36.0, 25.0, 25.0, 49.0, 133.0, 29.0, 349.0, 400.0, 151.0, 145.0, 59.0, 169.0, 53.0, 133.0, 190.0, 66.0, 174.0, 404.0, 289.0, 37.0, 150.0, 182.0, 27.0, 144.0, 154.0, 242.0, 159.0, 270.0, 336.0, 183.0, 381.0, 359.0, 268.0, 148.0, 124.0, 90.0, 68.0, 151.0, 410.0, 309.0, 190.0, 271.0, 360.0, 327.0, 393.0, 318.0, 344.0, 417.0, 415.0, 264.0, 500.0, 427.0, 369.0, 369.0, 500.0, 500.0, 500.0, 500.0, 455.0, 500.0, 500.0, 500.0, 354.0, 500.0, 500.0, 500.0, 309.0, 499.0, 500.0, 500.0, 500.0, 497.0, 450.0, 500.0, 457.0, 471.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25059416490416736, "mean_inference_ms": 0.9680015537836278, "mean_action_processing_ms": 0.09991915151329994, "mean_env_wait_ms": 0.04185722279670733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037708282470703125, "StateBufferConnector_ms": 0.0037806034088134766, "ViewRequirementAgentConnector_ms": 0.10131049156188965}, "num_episodes": 8, "episode_return_max": 500.0, "episode_return_min": 14.0, "episode_return_mean": 320.96, "episodes_this_iter": 8}, "num_healthy_workers": 2, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.6978348850175, "num_env_steps_trained_throughput_per_sec": 498.6978348850175, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8072.837, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8072.801, "sample_time_ms": 2734.955, "load_time_ms": 0.382, "load_throughput": 10479210.493, "learn_time_ms": 5332.251, "learn_throughput": 750.152, "synch_weights_time_ms": 4.754}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": true, "training_iteration": 10, "trial_id": "08dc1_00002", "date": "2024-11-15_06-45-46", "timestamp": 1731653146, "time_this_iter_s": 8.023929834365845, "time_total_s": 80.7636137008667, "pid": 7150, "hostname": "ip-172-31-17-56", "node_ip": "172.31.17.56", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "max_requests_in_flight_per_env_runner": 2, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79cf1b2c6480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "recreate_failed_env_runners": false, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.7636137008667, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.872727272727275, "ram_util_percent": 31.2}}
